{"iteration": 12, "timestamp": "2025-11-12T05:00:50.090531Z", "summary": {"episodes": 12, "avg_final_survival_rate": 0.4157986111111111, "min_final_survival_rate": 0.20833333333333334, "avg_min_survival_rate": 0.4157986111111111, "min_of_min_survival_rate": 0.20833333333333334, "median_min_survival_rate": 0.43229166666666663}, "death_stats": {"total_fish_samples": 1152, "survival_fraction": 0.4157986111111111, "mean_death_step": 365.64756944444446, "median_death_step": 456.0, "p10": 88.10000000000001, "p25": 245.0, "p75": 500.0, "p90": 500.0, "early_death_fraction_100": 0.11024305555555555, "early_death_fraction_150": 0.1484375}, "density_penalty_coef": 0.02, "escape_boost_speed": 0.75, "step_one_death_count": 22, "step_one_death_ratio": 0.019097222222222224, "episode_seeds": [774941881, 1153548809, 1861755986, 1855747823, 572279594, 1383995792, 191515877, 1511445902, 867792330, 168081687, 910731157, 737386597], "multi_eval_num_fish": 96, "multi_eval_episodes": 12, "death_hist_path": "/Users/grapeot/co/fish_rl/experiments/v35/artifacts/plots/dev_v35_tail_loop_stage3_full1_multi_eval_hist/dev_v35_tail_loop_stage3_full1_iter012_death_hist.png", "step_one_deaths": [{"fish_idx": 74, "predator_index": 0, "fish_position": [2.906355619430542, 1.1893866062164307], "predator_position": [2.3010356426239014, 1.2509708404541016], "predator_velocity": [1.7640148401260376, 0.8338525295257568]}, {"fish_idx": 90, "predator_index": 0, "fish_position": [2.1373982429504395, 1.3564419746398926], "predator_position": [2.3010356426239014, 1.2509708404541016], "predator_velocity": [1.7640148401260376, 0.8338525295257568]}, {"fish_idx": 32, "predator_index": 0, "fish_position": [0.9577363133430481, -0.233542799949646], "predator_position": [0.9952998161315918, 0.33232542872428894], "predator_velocity": [0.8290995955467224, 1.7638113498687744]}, {"fish_idx": 74, "predator_index": 0, "fish_position": [0.7034750580787659, 0.21024015545845032], "predator_position": [0.9952998161315918, 0.33232542872428894], "predator_velocity": [0.8290995955467224, 1.7638113498687744]}, {"fish_idx": 82, "predator_index": 0, "fish_position": [0.4153237044811249, 0.3951602876186371], "predator_position": [0.9952998161315918, 0.33232542872428894], "predator_velocity": [0.8290995955467224, 1.7638113498687744]}, {"fish_idx": 30, "predator_index": 0, "fish_position": [-0.34136730432510376, -1.2032246589660645], "predator_position": [-0.3765838146209717, -1.7333191633224487], "predator_velocity": [-0.004209754057228565, 0.09250052273273468]}, {"fish_idx": 65, "predator_index": 0, "fish_position": [-0.07640423625707626, -2.2065861225128174], "predator_position": [-0.3765838146209717, -1.7333191633224487], "predator_velocity": [-0.004209754057228565, 0.09250052273273468]}, {"fish_idx": 48, "predator_index": 0, "fish_position": [-2.535912036895752, -1.186018705368042], "predator_position": [-2.0885024070739746, -1.2298262119293213], "predator_velocity": [-0.760752260684967, 0.2731790244579315]}, {"fish_idx": 87, "predator_index": 0, "fish_position": [-1.477701187133789, -1.5524075031280518], "predator_position": [-2.0885024070739746, -1.2298262119293213], "predator_velocity": [-0.760752260684967, 0.2731790244579315]}, {"fish_idx": 52, "predator_index": 0, "fish_position": [-0.9645503759384155, -0.8084606528282166], "predator_position": [-1.0634623765945435, -0.9775975942611694], "predator_velocity": [-0.36480847001075745, 0.761989176273346]}, {"fish_idx": 37, "predator_index": 0, "fish_position": [-1.1555794477462769, 1.3488000631332397], "predator_position": [-0.7424460649490356, 0.864992082118988], "predator_velocity": [-0.09307053685188293, 0.16470922529697418]}, {"fish_idx": 57, "predator_index": 0, "fish_position": [-0.42707565426826477, 0.8322850465774536], "predator_position": [-0.7424460649490356, 0.864992082118988], "predator_velocity": [-0.09307053685188293, 0.16470922529697418]}, {"fish_idx": 74, "predator_index": 0, "fish_position": [-0.9041037559509277, 1.1748127937316895], "predator_position": [-0.7424460649490356, 0.864992082118988], "predator_velocity": [-0.09307053685188293, 0.16470922529697418]}, {"fish_idx": 52, "predator_index": 0, "fish_position": [-0.4770425856113434, 1.7816282510757446], "predator_position": [-0.4166224002838135, 1.6821062564849854], "predator_velocity": [0.6966865062713623, 2.507636547088623]}, {"fish_idx": 28, "predator_index": 0, "fish_position": [-2.682227373123169, -1.637325644493103], "predator_position": [-2.1343889236450195, -1.3947831392288208], "predator_velocity": [-1.3844845294952393, 0.18155983090400696]}, {"fish_idx": 62, "predator_index": 0, "fish_position": [-2.7505276203155518, -1.2799113988876343], "predator_position": [-2.1343889236450195, -1.3947831392288208], "predator_velocity": [-1.3844845294952393, 0.18155983090400696]}, {"fish_idx": 85, "predator_index": 0, "fish_position": [-2.5584378242492676, -1.8139606714248657], "predator_position": [-2.1343889236450195, -1.3947831392288208], "predator_velocity": [-1.3844845294952393, 0.18155983090400696]}, {"fish_idx": 5, "predator_index": 0, "fish_position": [-2.077402114868164, -1.3850255012512207], "predator_position": [-2.336608409881592, -0.7377360463142395], "predator_velocity": [-0.532706081867218, 0.631212055683136]}, {"fish_idx": 70, "predator_index": 0, "fish_position": [0.5054981708526611, 2.3136539459228516], "predator_position": [0.09903616458177567, 1.948354959487915], "predator_velocity": [0.2353382110595703, 1.7114295959472656]}, {"fish_idx": 81, "predator_index": 0, "fish_position": [-1.537110686302185, 1.002420425415039], "predator_position": [-1.8695952892303467, 1.1616030931472778], "predator_velocity": [-0.36744174361228943, 1.3977464437484741]}, {"fish_idx": 88, "predator_index": 0, "fish_position": [-1.7111542224884033, 0.6181527376174927], "predator_position": [-1.8695952892303467, 1.1616030931472778], "predator_velocity": [-0.36744174361228943, 1.3977464437484741]}, {"fish_idx": 51, "predator_index": 0, "fish_position": [-2.558561086654663, -0.3625037372112274], "predator_position": [-2.015226364135742, 0.0028769224882125854], "predator_velocity": [-1.3161557912826538, 0.3170402944087982]}], "step_one_clusters": {"total": 22, "angle_bin_deg": 30.0, "speed_bin": 0.4, "clusters": [{"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 5, "share": 0.22727272727272727}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 1.6, "speed_bin_end": 2.0, "count": 4, "share": 0.18181818181818182}, {"angle_deg_start": 150.0, "angle_deg_end": 180.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 4, "share": 0.18181818181818182}, {"angle_deg_start": 0.0, "angle_deg_end": 30.0, "speed_bin_start": 1.6, "speed_bin_end": 2.0, "count": 2, "share": 0.09090909090909091}, {"angle_deg_start": 150.0, "angle_deg_end": 180.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 2, "share": 0.09090909090909091}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 2, "share": 0.09090909090909091}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 1, "share": 0.045454545454545456}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 2.4000000000000004, "speed_bin_end": 2.8000000000000003, "count": 1, "share": 0.045454545454545456}, {"angle_deg_start": 120.0, "angle_deg_end": 150.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 1, "share": 0.045454545454545456}]}, "step_one_ne_high_speed_share": 0.0, "pre_roll_stats_summary": {"sampled_episodes": 12, "spawn_radius": {"count": 12, "mean": 0.5589289168516794, "std": 0.3052254422125611, "p10": 0.19881808012723923, "p50": 0.522914320230484, "p90": 1.0054110169410706, "min": 0.06267373263835907, "max": 1.0209442377090454}, "spawn_angle_deg": {"count": 12, "mean": -18.653139114379883, "std": 102.32357309052745, "p10": -118.45354309082032, "p50": -40.86918067932129, "p90": 153.6759052276612, "min": -161.15975952148438, "max": 170.54266357421875}, "initial_heading_deg": {"count": 12, "mean": -21.126052300135296, "std": 110.47910795938708, "p10": -133.37953338623046, "p50": -82.96360778808594, "p90": 148.85515518188478, "min": -141.34104919433594, "max": 165.15914916992188}, "final_heading_deg": {"count": 12, "mean": 110.88358004887898, "std": 43.95684100820149, "p10": 65.18241577148437, "p50": 111.18990325927734, "p90": 168.04263916015626, "min": 23.95830726623535, "max": 174.57179260253906}, "initial_speed": {"count": 12, "mean": 1.5000000198682149, "std": 4.442667916416704e-08, "p10": 1.5, "p50": 1.5, "p90": 1.5000001072883606, "min": 1.5, "max": 1.5000001192092896}, "final_speed": {"count": 12, "mean": 1.230744327728947, "std": 0.7140228002405327, "p10": 0.2117859140038491, "p50": 1.3668470978736877, "p90": 1.9276794791221619, "min": 0.04270850867033005, "max": 2.554476499557495}, "angle_jitter_deg": {"count": 192, "mean": -0.9636220478324936, "std": 9.652585147837254, "p10": -13.041356446384285, "p50": -1.6047699221001979, "p90": 12.419418027173176, "min": -17.174849497496247, "max": 17.1416914290722}, "speed_scale": {"count": 192, "mean": 2.6624735134212067, "std": 9.264681366105668, "p10": 0.22593161732486594, "p50": 1.0528365717136337, "p90": 3.9966127656935058, "min": 0.0042783345872691335, "max": 99.7522731139596}, "heading_bias_angle_deg": {"count": 12, "mean": 188.8739470941979, "std": 84.76554875847309, "p10": 74.19057637337104, "p50": 221.64309209258306, "p90": 274.2989605924975, "min": 10.032652889952915, "max": 278.59455472215484}, "prewarm_override_count": 0, "prewarm_override_ratio": 0.0, "spawn_angle_hist_deg": {"bins": [2, 1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0], "edges": [0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, 210.0, 240.0, 270.0, 300.0, 330.0, 360.0]}, "initial_speed_hist": {"bins": [0, 0, 0, 0, 0, 0, 0, 0, 0, 12], "edges": [0.0, 0.16, 0.32, 0.48, 0.64, 0.8, 0.96, 1.12, 1.28, 1.44, 1.6]}}, "penalty_gate": {"event": "failure_hold", "stage": 0, "phase_limit": 3, "success_streak": 0, "freeze_until": 17, "failure_detected": true, "failure_streak": 1, "step_one_death_ratio": 0.019097222222222224}}
{"iteration": 24, "timestamp": "2025-11-12T05:04:20.129521Z", "summary": {"episodes": 12, "avg_final_survival_rate": 0.36284722222222227, "min_final_survival_rate": 0.17708333333333334, "avg_min_survival_rate": 0.36284722222222227, "min_of_min_survival_rate": 0.17708333333333334, "median_min_survival_rate": 0.30729166666666663}, "death_stats": {"total_fish_samples": 1152, "survival_fraction": 0.3628472222222222, "mean_death_step": 351.7326388888889, "median_death_step": 437.5, "p10": 68.0, "p25": 211.0, "p75": 500.0, "p90": 500.0, "early_death_fraction_100": 0.12065972222222222, "early_death_fraction_150": 0.15538194444444445}, "density_penalty_coef": 0.04, "escape_boost_speed": 0.76, "step_one_death_count": 24, "step_one_death_ratio": 0.020833333333333332, "episode_seeds": [738549808, 750061058, 308979966, 125465265, 445253941, 428959627, 1020527185, 1691489846, 1120166328, 1896091936, 1164830179, 2083242502], "multi_eval_num_fish": 96, "multi_eval_episodes": 12, "death_hist_path": "/Users/grapeot/co/fish_rl/experiments/v35/artifacts/plots/dev_v35_tail_loop_stage3_full1_multi_eval_hist/dev_v35_tail_loop_stage3_full1_iter024_death_hist.png", "step_one_deaths": [{"fish_idx": 48, "predator_index": 0, "fish_position": [1.4806402921676636, 0.6978997588157654], "predator_position": [1.185570240020752, 0.5269166231155396], "predator_velocity": [0.5797194242477417, 1.4771525859832764]}, {"fish_idx": 68, "predator_index": 0, "fish_position": [1.805855393409729, 0.46128958463668823], "predator_position": [1.185570240020752, 0.5269166231155396], "predator_velocity": [0.5797194242477417, 1.4771525859832764]}, {"fish_idx": 31, "predator_index": 0, "fish_position": [-1.9066007137298584, -0.5739263296127319], "predator_position": [-2.2525148391723633, -0.257306307554245], "predator_velocity": [-0.36787620186805725, 2.0219876766204834]}, {"fish_idx": 79, "predator_index": 0, "fish_position": [-1.8398990631103516, -0.5775929689407349], "predator_position": [-2.2525148391723633, -0.257306307554245], "predator_velocity": [-0.36787620186805725, 2.0219876766204834]}, {"fish_idx": 15, "predator_index": 0, "fish_position": [3.745340585708618, -1.4961707592010498], "predator_position": [3.4256699085235596, -0.9288480281829834], "predator_velocity": [2.424006938934326, 0.08242492377758026]}, {"fish_idx": 22, "predator_index": 0, "fish_position": [3.393080711364746, -0.3488177955150604], "predator_position": [3.4256699085235596, -0.9288480281829834], "predator_velocity": [2.424006938934326, 0.08242492377758026]}, {"fish_idx": 57, "predator_index": 0, "fish_position": [3.8728456497192383, -1.0204004049301147], "predator_position": [3.4256699085235596, -0.9288480281829834], "predator_velocity": [2.424006938934326, 0.08242492377758026]}, {"fish_idx": 66, "predator_index": 0, "fish_position": [3.8030436038970947, -0.5313606858253479], "predator_position": [3.4256699085235596, -0.9288480281829834], "predator_velocity": [2.424006938934326, 0.08242492377758026]}, {"fish_idx": 87, "predator_index": 0, "fish_position": [3.7049949169158936, -0.8381460309028625], "predator_position": [3.4256699085235596, -0.9288480281829834], "predator_velocity": [2.424006938934326, 0.08242492377758026]}, {"fish_idx": 4, "predator_index": 0, "fish_position": [1.3383780717849731, 2.9976956844329834], "predator_position": [1.5456312894821167, 2.7135889530181885], "predator_velocity": [0.08686351031064987, 2.2969439029693604]}, {"fish_idx": 56, "predator_index": 0, "fish_position": [1.152385950088501, 2.1714956760406494], "predator_position": [1.5456312894821167, 2.7135889530181885], "predator_velocity": [0.08686351031064987, 2.2969439029693604]}, {"fish_idx": 17, "predator_index": 0, "fish_position": [-0.3203902244567871, 1.9524102210998535], "predator_position": [-0.6587538123130798, 1.8783159255981445], "predator_velocity": [0.4895246624946594, 1.5956735610961914]}, {"fish_idx": 41, "predator_index": 0, "fish_position": [-0.9214745759963989, 2.128338098526001], "predator_position": [-0.6587538123130798, 1.8783159255981445], "predator_velocity": [0.4895246624946594, 1.5956735610961914]}, {"fish_idx": 47, "predator_index": 0, "fish_position": [-0.3910013735294342, 1.3732521533966064], "predator_position": [-0.6587538123130798, 1.8783159255981445], "predator_velocity": [0.4895246624946594, 1.5956735610961914]}, {"fish_idx": 30, "predator_index": 0, "fish_position": [0.5434656739234924, 1.9412145614624023], "predator_position": [0.6468811631202698, 2.242039680480957], "predator_velocity": [0.05193238705396652, 1.7200521230697632]}, {"fish_idx": 50, "predator_index": 0, "fish_position": [0.54091876745224, 2.2849156856536865], "predator_position": [0.6468811631202698, 2.242039680480957], "predator_velocity": [0.05193238705396652, 1.7200521230697632]}, {"fish_idx": 95, "predator_index": 0, "fish_position": [0.3633018434047699, 2.312380075454712], "predator_position": [0.6468811631202698, 2.242039680480957], "predator_velocity": [0.05193238705396652, 1.7200521230697632]}, {"fish_idx": 82, "predator_index": 0, "fish_position": [1.7924895286560059, -2.7086894512176514], "predator_position": [1.7606050968170166, -2.2073445320129395], "predator_velocity": [1.4614262580871582, 0.09778861701488495]}, {"fish_idx": 11, "predator_index": 0, "fish_position": [1.5594274997711182, 0.9409416317939758], "predator_position": [1.3187029361724854, 1.4515951871871948], "predator_velocity": [-0.002321785781532526, 0.2833990156650543]}, {"fish_idx": 83, "predator_index": 0, "fish_position": [1.4335418939590454, 1.3537079095840454], "predator_position": [1.3187029361724854, 1.4515951871871948], "predator_velocity": [-0.002321785781532526, 0.2833990156650543]}, {"fish_idx": 89, "predator_index": 0, "fish_position": [1.244254231452942, 1.7352019548416138], "predator_position": [1.3187029361724854, 1.4515951871871948], "predator_velocity": [-0.002321785781532526, 0.2833990156650543]}, {"fish_idx": 38, "predator_index": 0, "fish_position": [0.8692891597747803, 2.469318151473999], "predator_position": [1.426758885383606, 2.8724756240844727], "predator_velocity": [0.19865280389785767, 2.7668633460998535]}, {"fish_idx": 41, "predator_index": 0, "fish_position": [-3.149085521697998, 0.6669883728027344], "predator_position": [-2.5882415771484375, 0.27923959493637085], "predator_velocity": [-0.2714545428752899, 0.2262115180492401]}, {"fish_idx": 50, "predator_index": 0, "fish_position": [-2.044673204421997, 0.6525712013244629], "predator_position": [-2.5882415771484375, 0.27923959493637085], "predator_velocity": [-0.2714545428752899, 0.2262115180492401]}], "step_one_clusters": {"total": 24, "angle_bin_deg": 30.0, "speed_bin": 0.4, "clusters": [{"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 1.6, "speed_bin_end": 2.0, "count": 6, "share": 0.25}, {"angle_deg_start": 0.0, "angle_deg_end": 30.0, "speed_bin_start": 2.4000000000000004, "speed_bin_end": 2.8000000000000003, "count": 5, "share": 0.20833333333333334}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 3, "share": 0.125}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 2, "share": 0.08333333333333333}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 2.0, "speed_bin_end": 2.4000000000000004, "count": 2, "share": 0.08333333333333333}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 2.0, "speed_bin_end": 2.4000000000000004, "count": 2, "share": 0.08333333333333333}, {"angle_deg_start": 120.0, "angle_deg_end": 150.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 2, "share": 0.08333333333333333}, {"angle_deg_start": 0.0, "angle_deg_end": 30.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 1, "share": 0.041666666666666664}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 2.4000000000000004, "speed_bin_end": 2.8000000000000003, "count": 1, "share": 0.041666666666666664}]}, "step_one_ne_high_speed_share": 0.08333333333333333, "pre_roll_stats_summary": {"sampled_episodes": 12, "spawn_radius": {"count": 12, "mean": 0.9475959415237108, "std": 0.5046276488475614, "p10": 0.31340904235839845, "p50": 1.0757381319999695, "p90": 1.5514251232147218, "min": 0.012038618326187134, "max": 1.5775048732757568}, "spawn_angle_deg": {"count": 12, "mean": -27.6224311987559, "std": 101.16519898827714, "p10": -157.26529388427736, "p50": -9.769936084747314, "p90": 55.842319107055665, "min": -173.1353759765625, "max": 164.61669921875}, "initial_heading_deg": {"count": 12, "mean": -51.146505239109196, "std": 57.023876817165544, "p10": -104.62021713256836, "p50": -69.72858428955078, "p90": 28.05843172073365, "min": -144.85134887695312, "max": 42.475181579589844}, "final_heading_deg": {"count": 12, "mean": 45.42161155243715, "std": 74.98132338602548, "p10": -87.42559326291084, "p50": 79.12236404418945, "p90": 99.56739807128906, "min": -100.64553833007812, "max": 147.01084899902344}, "initial_speed": {"count": 12, "mean": 1.4999999900658925, "std": 5.877097232242043e-08, "p10": 1.4999998927116394, "p50": 1.5, "p90": 1.5, "min": 1.4999998807907104, "max": 1.5000001192092896}, "final_speed": {"count": 12, "mean": 1.558369009445111, "std": 0.7261924259302197, "p10": 0.40604093372821815, "p50": 1.580870807170868, "p90": 2.406663751602173, "min": 0.2334105521440506, "max": 2.724116325378418}, "angle_jitter_deg": {"count": 192, "mean": -0.24739116283383067, "std": 9.95280714867898, "p10": -14.07518958414059, "p50": -1.8432006162203183, "p90": 13.937078616065675, "min": -17.18345393676071, "max": 16.893735680527943}, "speed_scale": {"count": 192, "mean": 2.939809883928118, "std": 8.917552367807636, "p10": 0.19257572329536984, "p50": 0.9388805373288605, "p90": 4.533010899428982, "min": 0.016416540615917487, "max": 95.42358703823388}, "heading_bias_angle_deg": {"count": 12, "mean": 188.85349157817495, "std": 122.10638236438444, "p10": 10.143302197979912, "p50": 259.6920551223489, "p90": 294.6087507253824, "min": 0.43294952774813433, "max": 326.10576920017024}, "prewarm_override_count": 0, "prewarm_override_ratio": 0.0, "spawn_angle_hist_deg": {"bins": [2, 3, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0], "edges": [0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, 210.0, 240.0, 270.0, 300.0, 330.0, 360.0]}, "initial_speed_hist": {"bins": [0, 0, 0, 0, 0, 0, 0, 0, 0, 12], "edges": [0.0, 0.16, 0.32, 0.48, 0.64, 0.8, 0.96, 1.12, 1.28, 1.44, 1.6]}}, "penalty_gate": {"event": "failure_hold", "stage": 0, "phase_limit": 3, "success_streak": 0, "freeze_until": 29, "failure_detected": true, "failure_streak": 2, "rolling_p10_median": 78.05000000000001, "step_one_death_ratio": 0.020833333333333332}}
{"iteration": 36, "timestamp": "2025-11-12T05:07:58.066039Z", "summary": {"episodes": 12, "avg_final_survival_rate": 0.46875000000000006, "min_final_survival_rate": 0.3020833333333333, "avg_min_survival_rate": 0.46875000000000006, "min_of_min_survival_rate": 0.3020833333333333, "median_min_survival_rate": 0.3645833333333333}, "death_stats": {"total_fish_samples": 1152, "survival_fraction": 0.46875, "mean_death_step": 361.7526041666667, "median_death_step": 474.0, "p10": 84.30000000000003, "p25": 236.75, "p75": 500.0, "p90": 500.0, "early_death_fraction_100": 0.1076388888888889, "early_death_fraction_150": 0.16493055555555555}, "density_penalty_coef": 0.05, "escape_boost_speed": 0.78, "step_one_death_count": 17, "step_one_death_ratio": 0.014756944444444444, "episode_seeds": [738018994, 1990562448, 519920504, 1872247923, 605400529, 1411260238, 1018197675, 308067299, 625475757, 1242902654, 1587658396, 446394293], "multi_eval_num_fish": 96, "multi_eval_episodes": 12, "death_hist_path": "/Users/grapeot/co/fish_rl/experiments/v35/artifacts/plots/dev_v35_tail_loop_stage3_full1_multi_eval_hist/dev_v35_tail_loop_stage3_full1_iter036_death_hist.png", "step_one_deaths": [{"fish_idx": 44, "predator_index": 0, "fish_position": [0.4944323003292084, 0.130388543009758], "predator_position": [0.8780614137649536, 0.4308639168739319], "predator_velocity": [0.8150800466537476, 2.305192708969116]}, {"fish_idx": 77, "predator_index": 0, "fish_position": [1.0921618938446045, 0.9531819820404053], "predator_position": [0.8780614137649536, 0.4308639168739319], "predator_velocity": [0.8150800466537476, 2.305192708969116]}, {"fish_idx": 92, "predator_index": 0, "fish_position": [0.2914940416812897, 0.2229822725057602], "predator_position": [0.8780614137649536, 0.4308639168739319], "predator_velocity": [0.8150800466537476, 2.305192708969116]}, {"fish_idx": 94, "predator_index": 0, "fish_position": [0.46359288692474365, 0.14401161670684814], "predator_position": [0.8780614137649536, 0.4308639168739319], "predator_velocity": [0.8150800466537476, 2.305192708969116]}, {"fish_idx": 19, "predator_index": 0, "fish_position": [1.0522874593734741, 2.7412967681884766], "predator_position": [1.3196810483932495, 2.4655137062072754], "predator_velocity": [1.1871734857559204, 1.0016348361968994]}, {"fish_idx": 20, "predator_index": 0, "fish_position": [1.0703420639038086, 3.093501567840576], "predator_position": [1.3196810483932495, 2.4655137062072754], "predator_velocity": [1.1871734857559204, 1.0016348361968994]}, {"fish_idx": 69, "predator_index": 0, "fish_position": [0.728911280632019, 2.4992408752441406], "predator_position": [1.3196810483932495, 2.4655137062072754], "predator_velocity": [1.1871734857559204, 1.0016348361968994]}, {"fish_idx": 78, "predator_index": 0, "fish_position": [0.7891911864280701, 2.7811551094055176], "predator_position": [1.3196810483932495, 2.4655137062072754], "predator_velocity": [1.1871734857559204, 1.0016348361968994]}, {"fish_idx": 76, "predator_index": 0, "fish_position": [0.8099582195281982, 0.06550993025302887], "predator_position": [0.8466408848762512, 0.6456372141838074], "predator_velocity": [-0.17332860827445984, 1.4600896835327148]}, {"fish_idx": 8, "predator_index": 0, "fish_position": [-1.773080825805664, -0.6790549159049988], "predator_position": [-1.5503203868865967, -1.110044240951538], "predator_velocity": [-0.05881056562066078, 0.050469473004341125]}, {"fish_idx": 5, "predator_index": 0, "fish_position": [-1.87394380569458, 0.31251785159111023], "predator_position": [-1.3478623628616333, 0.09716212749481201], "predator_velocity": [-0.7028402090072632, 1.7592780590057373]}, {"fish_idx": 25, "predator_index": 0, "fish_position": [-1.8564022779464722, -0.05460488796234131], "predator_position": [-1.3478623628616333, 0.09716212749481201], "predator_velocity": [-0.7028402090072632, 1.7592780590057373]}, {"fish_idx": 77, "predator_index": 0, "fish_position": [0.6865766644477844, 0.667087197303772], "predator_position": [0.9401174783706665, 0.9677103757858276], "predator_velocity": [-0.4593188464641571, 1.1062599420547485]}, {"fish_idx": 71, "predator_index": 0, "fish_position": [-2.863588571548462, -1.8881596326828003], "predator_position": [-2.855013370513916, -1.900613784790039], "predator_velocity": [-1.0106980800628662, -0.6082135438919067]}, {"fish_idx": 10, "predator_index": 0, "fish_position": [0.10094013065099716, 2.027292490005493], "predator_position": [0.6524219512939453, 1.7013535499572754], "predator_velocity": [0.6477352380752563, 0.7980338335037231]}, {"fish_idx": 26, "predator_index": 0, "fish_position": [0.08693038672208786, 2.0337226390838623], "predator_position": [0.6524219512939453, 1.7013535499572754], "predator_velocity": [0.6477352380752563, 0.7980338335037231]}, {"fish_idx": 65, "predator_index": 0, "fish_position": [0.03971107304096222, -1.525428295135498], "predator_position": [-0.060544777661561966, -1.5401188135147095], "predator_velocity": [0.02466689795255661, 0.08656957745552063]}], "step_one_clusters": {"total": 17, "angle_bin_deg": 30.0, "speed_bin": 0.4, "clusters": [{"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 2.4000000000000004, "speed_bin_end": 2.8000000000000003, "count": 4, "share": 0.23529411764705882}, {"angle_deg_start": 30.0, "angle_deg_end": 60.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 4, "share": 0.23529411764705882}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 1.6, "speed_bin_end": 2.0, "count": 2, "share": 0.11764705882352941}, {"angle_deg_start": 30.0, "angle_deg_end": 60.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 2, "share": 0.11764705882352941}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 1, "share": 0.058823529411764705}, {"angle_deg_start": 120.0, "angle_deg_end": 150.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 1, "share": 0.058823529411764705}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 1, "share": 0.058823529411764705}, {"angle_deg_start": 210.0, "angle_deg_end": 240.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 1, "share": 0.058823529411764705}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 1, "share": 0.058823529411764705}]}, "step_one_ne_high_speed_share": 0.11764705882352941, "pre_roll_stats_summary": {"sampled_episodes": 12, "spawn_radius": {"count": 12, "mean": 0.8184557513644298, "std": 0.47928330889262327, "p10": 0.2317106455564499, "p50": 0.750916063785553, "p90": 1.394730794429779, "min": 0.026864297688007355, "max": 1.581760287284851}, "spawn_angle_deg": {"count": 12, "mean": -64.78351227442424, "std": 93.16151062979306, "p10": -151.05993041992187, "p50": -117.16628646850586, "p90": 79.85842666625979, "min": -167.69813537597656, "max": 106.49132537841797}, "initial_heading_deg": {"count": 12, "mean": -60.155484199523926, "std": 63.90196256028368, "p10": -126.0297966003418, "p50": -79.35783767700195, "p90": 22.64385681152344, "min": -148.07144165039062, "max": 72.67996978759766}, "final_heading_deg": {"count": 12, "mean": 41.82263215382894, "std": 93.3926401131324, "p10": -110.13526763916015, "p50": 63.06425094604492, "p90": 113.3870018005371, "min": -146.9259490966797, "max": 179.54261779785156}, "initial_speed": {"count": 12, "mean": 1.4999999900658925, "std": 5.877097232242043e-08, "p10": 1.4999998927116394, "p50": 1.5, "p90": 1.5, "min": 1.4999998807907104, "max": 1.5000001192092896}, "final_speed": {"count": 12, "mean": 1.101132666071256, "std": 0.6920521041159347, "p10": 0.08395129144191744, "p50": 1.17896968126297, "p90": 1.8196466445922852, "min": 0.04411110281944275, "max": 2.39796781539917}, "angle_jitter_deg": {"count": 192, "mean": 1.8796799403431554, "std": 9.185460409831729, "p10": -10.06533045500147, "p50": 2.076435709214514, "p90": 14.700622270197556, "min": -17.124618473742903, "max": 17.166428701773842}, "speed_scale": {"count": 192, "mean": 1.918457436952704, "std": 4.382094726397647, "p10": 0.2265054793947898, "p50": 0.9305645521966301, "p90": 3.153349178111045, "min": 0.015751035684706663, "max": 52.43057581538043}, "heading_bias_angle_deg": {"count": 12, "mean": 209.84451130872503, "std": 104.5662104822558, "p10": 28.503743020057897, "p50": 254.03811675845384, "p90": 306.8210820571282, "min": 14.08110362340773, "max": 312.39198019611666}, "prewarm_override_count": 0, "prewarm_override_ratio": 0.0, "spawn_angle_hist_deg": {"bins": [0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], "edges": [0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, 210.0, 240.0, 270.0, 300.0, 330.0, 360.0]}, "initial_speed_hist": {"bins": [0, 0, 0, 0, 0, 0, 0, 0, 0, 12], "edges": [0.0, 0.16, 0.32, 0.48, 0.64, 0.8, 0.96, 1.12, 1.28, 1.44, 1.6]}}, "penalty_gate": {"event": "failure_hold", "stage": 0, "phase_limit": 3, "success_streak": 0, "freeze_until": 41, "failure_detected": true, "failure_streak": 3, "rolling_p10_median": 76.15, "step_one_death_ratio": 0.014756944444444444}}
{"iteration": 48, "timestamp": "2025-11-12T05:11:58.587490Z", "summary": {"episodes": 12, "avg_final_survival_rate": 0.5668402777777777, "min_final_survival_rate": 0.34375, "avg_min_survival_rate": 0.5668402777777777, "min_of_min_survival_rate": 0.34375, "median_min_survival_rate": 0.5364583333333334}, "death_stats": {"total_fish_samples": 1152, "survival_fraction": 0.5668402777777778, "mean_death_step": 385.1927083333333, "median_death_step": 500.0, "p10": 122.10000000000001, "p25": 252.75, "p75": 500.0, "p90": 500.0, "early_death_fraction_100": 0.0763888888888889, "early_death_fraction_150": 0.1371527777777778}, "density_penalty_coef": 0.05, "escape_boost_speed": 0.8, "step_one_death_count": 30, "step_one_death_ratio": 0.026041666666666668, "episode_seeds": [1742049905, 294693601, 1476793083, 957065028, 1998182649, 1357749028, 1721031093, 2015809762, 2087113229, 813441757, 953344873, 879581534], "multi_eval_num_fish": 96, "multi_eval_episodes": 12, "death_hist_path": "/Users/grapeot/co/fish_rl/experiments/v35/artifacts/plots/dev_v35_tail_loop_stage3_full1_multi_eval_hist/dev_v35_tail_loop_stage3_full1_iter048_death_hist.png", "step_one_deaths": [{"fish_idx": 9, "predator_index": 0, "fish_position": [-0.9711833000183105, 0.7716521620750427], "predator_position": [-0.939437210559845, 0.7516606450080872], "predator_velocity": [0.04255669191479683, 0.4266710877418518]}, {"fish_idx": 73, "predator_index": 0, "fish_position": [-1.2820518016815186, 0.6237115859985352], "predator_position": [-0.939437210559845, 0.7516606450080872], "predator_velocity": [0.04255669191479683, 0.4266710877418518]}, {"fish_idx": 87, "predator_index": 0, "fish_position": [-1.5320297479629517, 0.8423843383789062], "predator_position": [-0.939437210559845, 0.7516606450080872], "predator_velocity": [0.04255669191479683, 0.4266710877418518]}, {"fish_idx": 20, "predator_index": 0, "fish_position": [-1.057071566581726, 1.4008139371871948], "predator_position": [-1.2842570543289185, 1.5164920091629028], "predator_velocity": [-0.1225738525390625, 1.805695652961731]}, {"fish_idx": 30, "predator_index": 0, "fish_position": [-0.23832261562347412, -0.27434128522872925], "predator_position": [-0.3156190514564514, -0.421308308839798], "predator_velocity": [-0.4927907884120941, -0.044673722237348557]}, {"fish_idx": 39, "predator_index": 0, "fish_position": [0.17953705787658691, 0.017692774534225464], "predator_position": [-0.3156190514564514, -0.421308308839798], "predator_velocity": [-0.4927907884120941, -0.044673722237348557]}, {"fish_idx": 45, "predator_index": 0, "fish_position": [0.11581538617610931, 0.12815117835998535], "predator_position": [-0.3156190514564514, -0.421308308839798], "predator_velocity": [-0.4927907884120941, -0.044673722237348557]}, {"fish_idx": 74, "predator_index": 0, "fish_position": [-0.6323145627975464, -0.25953471660614014], "predator_position": [-0.3156190514564514, -0.421308308839798], "predator_velocity": [-0.4927907884120941, -0.044673722237348557]}, {"fish_idx": 80, "predator_index": 0, "fish_position": [-0.14047127962112427, 0.15929090976715088], "predator_position": [-0.3156190514564514, -0.421308308839798], "predator_velocity": [-0.4927907884120941, -0.044673722237348557]}, {"fish_idx": 88, "predator_index": 0, "fish_position": [0.21616166830062866, 0.004491414874792099], "predator_position": [-0.3156190514564514, -0.421308308839798], "predator_velocity": [-0.4927907884120941, -0.044673722237348557]}, {"fish_idx": 8, "predator_index": 0, "fish_position": [-0.5807933807373047, 0.22904542088508606], "predator_position": [-0.740821897983551, 0.012404650449752808], "predator_velocity": [-0.1570083647966385, 0.4754546582698822]}, {"fish_idx": 27, "predator_index": 0, "fish_position": [-0.515600860118866, -0.4466511011123657], "predator_position": [-0.740821897983551, 0.012404650449752808], "predator_velocity": [-0.1570083647966385, 0.4754546582698822]}, {"fish_idx": 42, "predator_index": 0, "fish_position": [-0.6879467368125916, -0.41935116052627563], "predator_position": [-0.740821897983551, 0.012404650449752808], "predator_velocity": [-0.1570083647966385, 0.4754546582698822]}, {"fish_idx": 52, "predator_index": 0, "fish_position": [-1.0459363460540771, 0.20461055636405945], "predator_position": [-0.740821897983551, 0.012404650449752808], "predator_velocity": [-0.1570083647966385, 0.4754546582698822]}, {"fish_idx": 80, "predator_index": 0, "fish_position": [-0.46830838918685913, -0.5849271416664124], "predator_position": [-0.740821897983551, 0.012404650449752808], "predator_velocity": [-0.1570083647966385, 0.4754546582698822]}, {"fish_idx": 8, "predator_index": 0, "fish_position": [0.3256208300590515, 0.6438180208206177], "predator_position": [0.6629937887191772, 0.06700880080461502], "predator_velocity": [0.0843558982014656, 0.10047733783721924]}, {"fish_idx": 10, "predator_index": 0, "fish_position": [0.1999625265598297, -0.15235404670238495], "predator_position": [0.6629937887191772, 0.06700880080461502], "predator_velocity": [0.0843558982014656, 0.10047733783721924]}, {"fish_idx": 32, "predator_index": 0, "fish_position": [1.0371509790420532, -0.054218314588069916], "predator_position": [0.6629937887191772, 0.06700880080461502], "predator_velocity": [0.0843558982014656, 0.10047733783721924]}, {"fish_idx": 41, "predator_index": 0, "fish_position": [0.227108433842659, 0.33424240350723267], "predator_position": [0.6629937887191772, 0.06700880080461502], "predator_velocity": [0.0843558982014656, 0.10047733783721924]}, {"fish_idx": 48, "predator_index": 0, "fish_position": [0.8164831399917603, 0.1817542016506195], "predator_position": [0.6629937887191772, 0.06700880080461502], "predator_velocity": [0.0843558982014656, 0.10047733783721924]}, {"fish_idx": 70, "predator_index": 0, "fish_position": [0.5831973552703857, -0.00019642803817987442], "predator_position": [0.6629937887191772, 0.06700880080461502], "predator_velocity": [0.0843558982014656, 0.10047733783721924]}, {"fish_idx": 80, "predator_index": 0, "fish_position": [0.3839072585105896, -0.4807422161102295], "predator_position": [0.6629937887191772, 0.06700880080461502], "predator_velocity": [0.0843558982014656, 0.10047733783721924]}, {"fish_idx": 67, "predator_index": 0, "fish_position": [-0.8804032206535339, 1.3415796756744385], "predator_position": [-0.8928378224372864, 1.049570918083191], "predator_velocity": [-0.08263833820819855, 0.2146153748035431]}, {"fish_idx": 61, "predator_index": 0, "fish_position": [-0.24888332188129425, 2.1356215476989746], "predator_position": [-0.20660468935966492, 2.3481390476226807], "predator_velocity": [-0.7106069326400757, 1.6325899362564087]}, {"fish_idx": 1, "predator_index": 0, "fish_position": [-0.13866686820983887, -1.3415769338607788], "predator_position": [0.316697359085083, -1.801727294921875], "predator_velocity": [0.14991343021392822, 0.9172186255455017]}, {"fish_idx": 33, "predator_index": 0, "fish_position": [1.9522181749343872, -0.30712491273880005], "predator_position": [2.162534475326538, 0.32091742753982544], "predator_velocity": [1.237033724784851, 0.4402884542942047]}, {"fish_idx": 87, "predator_index": 0, "fish_position": [1.628103494644165, -0.11149682104587555], "predator_position": [2.162534475326538, 0.32091742753982544], "predator_velocity": [1.237033724784851, 0.4402884542942047]}, {"fish_idx": 55, "predator_index": 0, "fish_position": [-0.024306297302246094, 1.7924387454986572], "predator_position": [0.12170746177434921, 1.6904972791671753], "predator_velocity": [0.09320879727602005, 0.3986758291721344]}, {"fish_idx": 81, "predator_index": 0, "fish_position": [0.24306976795196533, 1.8342164754867554], "predator_position": [0.12170746177434921, 1.6904972791671753], "predator_velocity": [0.09320879727602005, 0.3986758291721344]}, {"fish_idx": 3, "predator_index": 0, "fish_position": [-2.1973042488098145, -1.4507355690002441], "predator_position": [-1.6704732179641724, -1.309217095375061], "predator_velocity": [-1.8389124870300293, -1.0038354396820068]}], "step_one_clusters": {"total": 30, "angle_bin_deg": 30.0, "speed_bin": 0.4, "clusters": [{"angle_deg_start": 30.0, "angle_deg_end": 60.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 7, "share": 0.23333333333333334}, {"angle_deg_start": 180.0, "angle_deg_end": 210.0, "speed_bin_start": 0.4, "speed_bin_end": 0.8, "count": 6, "share": 0.2}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 0.4, "speed_bin_end": 0.8, "count": 5, "share": 0.16666666666666666}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.4, "speed_bin_end": 0.8, "count": 5, "share": 0.16666666666666666}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 1.6, "speed_bin_end": 2.0, "count": 2, "share": 0.06666666666666667}, {"angle_deg_start": 0.0, "angle_deg_end": 30.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 2, "share": 0.06666666666666667}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 1, "share": 0.03333333333333333}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 1, "share": 0.03333333333333333}, {"angle_deg_start": 180.0, "angle_deg_end": 210.0, "speed_bin_start": 2.0, "speed_bin_end": 2.4000000000000004, "count": 1, "share": 0.03333333333333333}]}, "step_one_ne_high_speed_share": 0.06666666666666667, "pre_roll_stats_summary": {"sampled_episodes": 12, "spawn_radius": {"count": 12, "mean": 0.49589158858483035, "std": 0.4136119059852634, "p10": 0.07044060751795769, "p50": 0.40598638355731964, "p90": 1.1983464121818543, "min": 0.02235461212694645, "max": 1.2920751571655273}, "spawn_angle_deg": {"count": 12, "mean": 22.93451499938965, "std": 97.73919864301577, "p10": -85.10960006713867, "p50": 32.133670806884766, "p90": 141.88710174560546, "min": -120.24991607666016, "max": 165.07177734375}, "initial_heading_deg": {"count": 12, "mean": -57.161104679107666, "std": 96.75049773914645, "p10": -161.2106170654297, "p50": -91.49388885498047, "p90": 82.19426078796387, "min": -173.1026153564453, "max": 112.88047790527344}, "final_heading_deg": {"count": 12, "mean": 40.82807413736979, "std": 94.27798796578296, "p10": -133.41456604003906, "p50": 81.87318801879883, "p90": 113.78831176757812, "min": -169.12496948242188, "max": 116.65704345703125}, "initial_speed": {"count": 12, "mean": 1.5000000099341075, "std": 5.877097232242043e-08, "p10": 1.5, "p50": 1.5, "p90": 1.5000001072883606, "min": 1.4999998807907104, "max": 1.5000001192092896}, "final_speed": {"count": 12, "mean": 0.8222168119003376, "std": 0.6909135193835089, "p10": 0.10689389854669572, "p50": 0.4776518940925598, "p90": 1.757452952861786, "min": 0.09734036773443222, "max": 2.119473695755005}, "angle_jitter_deg": {"count": 192, "mean": 0.007849686943260492, "std": 9.817206501842735, "p10": -13.996725069986848, "p50": 0.4237823477247613, "p90": 13.798849417969846, "min": -17.042559175292336, "max": 17.036210310681316}, "speed_scale": {"count": 192, "mean": 2.0228039291088837, "std": 4.505203715318576, "p10": 0.20272384701108337, "p50": 0.9091598245027996, "p90": 3.49610751736812, "min": 0.008388628359341508, "max": 41.672598459513615}, "heading_bias_angle_deg": {"count": 12, "mean": 182.83889338441716, "std": 88.71721183728361, "p10": 64.7830192646736, "p50": 201.83289073995397, "p90": 277.86916633949113, "min": 16.32973858976353, "max": 303.9682771496569}, "prewarm_override_count": 0, "prewarm_override_ratio": 0.0, "spawn_angle_hist_deg": {"bins": [1, 0, 2, 1, 2, 1, 0, 0, 0, 0, 0, 0], "edges": [0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, 210.0, 240.0, 270.0, 300.0, 330.0, 360.0]}, "initial_speed_hist": {"bins": [0, 0, 0, 0, 0, 0, 0, 0, 0, 12], "edges": [0.0, 0.16, 0.32, 0.48, 0.64, 0.8, 0.96, 1.12, 1.28, 1.44, 1.6]}}, "penalty_gate": {"event": "failure_hold", "stage": 0, "phase_limit": 3, "success_streak": 0, "freeze_until": 53, "failure_detected": true, "failure_streak": 4, "rolling_p10_median": 103.20000000000002, "step_one_death_ratio": 0.026041666666666668}}
