{"iteration": 8, "timestamp": "2025-11-12T10:44:20.795160Z", "summary": {"episodes": 16, "avg_final_survival_rate": 0.8450520833333334, "min_final_survival_rate": 0.7604166666666666, "avg_min_survival_rate": 0.8450520833333334, "min_of_min_survival_rate": 0.7604166666666666, "median_min_survival_rate": 0.859375}, "death_stats": {"total_fish_samples": 1536, "survival_fraction": 0.8450520833333334, "mean_death_step": 436.2513020833333, "median_death_step": 500.0, "p10": 102.5, "p25": 500.0, "p75": 500.0, "p90": 500.0, "early_death_fraction_100": 0.09895833333333333, "early_death_fraction_150": 0.12109375}, "density_penalty_coef": 0.0, "escape_boost_speed": 0.75, "step_one_death_count": 31, "step_one_death_ratio": 0.020182291666666668, "episode_seeds": [774941881, 1153548809, 1861755986, 1855747823, 572279594, 1383995792, 191515877, 1511445902, 867792330, 168081687, 910731157, 737386597, 738549808, 750061058, 308979966, 125465265], "multi_eval_num_fish": 96, "multi_eval_episodes": 16, "tail_stage_label": "stage1:tail_seed_mix_v34_ne", "tail_stage_type": "ne", "tail_stage_remaining_by_type": {"ne": 1152, "main": 12800}, "tail_stage_warn_active": false, "tail_stage_warn_since": null, "death_hist_path": "/Users/grapeot/co/fish_rl/experiments/v39/artifacts/plots/dev_v39_stageaware_gate_v1_longrun_multi_eval_hist/dev_v39_stageaware_gate_v1_longrun_iter008_death_hist.png", "step_one_deaths": [{"fish_idx": 74, "predator_index": 0, "fish_position": [2.886544704437256, 1.1741379499435425], "predator_position": [2.3010356426239014, 1.2509708404541016], "predator_velocity": [1.7640148401260376, 0.8338525295257568]}, {"fish_idx": 90, "predator_index": 0, "fish_position": [2.180061101913452, 1.2878077030181885], "predator_position": [2.3010356426239014, 1.2509708404541016], "predator_velocity": [1.7640148401260376, 0.8338525295257568]}, {"fish_idx": 32, "predator_index": 0, "fish_position": [0.9567704200744629, -0.3143502473831177], "predator_position": [0.9952998161315918, 0.33232542872428894], "predator_velocity": [0.8290995955467224, 1.7638113498687744]}, {"fish_idx": 74, "predator_index": 0, "fish_position": [0.709380030632019, 0.12964293360710144], "predator_position": [0.9952998161315918, 0.33232542872428894], "predator_velocity": [0.8290995955467224, 1.7638113498687744]}, {"fish_idx": 82, "predator_index": 0, "fish_position": [0.42638781666755676, 0.3151080310344696], "predator_position": [0.9952998161315918, 0.33232542872428894], "predator_velocity": [0.8290995955467224, 1.7638113498687744]}, {"fish_idx": 30, "predator_index": 0, "fish_position": [-0.34167492389678955, -1.1782264709472656], "predator_position": [-0.3765838146209717, -1.7333191633224487], "predator_velocity": [-0.004209754057228565, 0.09250052273273468]}, {"fish_idx": 65, "predator_index": 0, "fish_position": [-0.06797950714826584, -2.1830482482910156], "predator_position": [-0.3765838146209717, -1.7333191633224487], "predator_velocity": [-0.004209754057228565, 0.09250052273273468]}, {"fish_idx": 48, "predator_index": 0, "fish_position": [-2.535912036895752, -1.186018705368042], "predator_position": [-2.0885024070739746, -1.2298262119293213], "predator_velocity": [-0.760752260684967, 0.2731790244579315]}, {"fish_idx": 87, "predator_index": 0, "fish_position": [-1.477701187133789, -1.5524075031280518], "predator_position": [-2.0885024070739746, -1.2298262119293213], "predator_velocity": [-0.760752260684967, 0.2731790244579315]}, {"fish_idx": 52, "predator_index": 0, "fish_position": [-0.9413557052612305, -0.799132764339447], "predator_position": [-1.0634623765945435, -0.9775975942611694], "predator_velocity": [-0.36480847001075745, 0.761989176273346]}, {"fish_idx": 37, "predator_index": 0, "fish_position": [-1.141263484954834, 1.3283048868179321], "predator_position": [-0.7424460649490356, 0.864992082118988], "predator_velocity": [-0.09307053685188293, 0.16470922529697418]}, {"fish_idx": 57, "predator_index": 0, "fish_position": [-0.41810140013694763, 0.8089513182640076], "predator_position": [-0.7424460649490356, 0.864992082118988], "predator_velocity": [-0.09307053685188293, 0.16470922529697418]}, {"fish_idx": 74, "predator_index": 0, "fish_position": [-0.8894198536872864, 1.154579520225525], "predator_position": [-0.7424460649490356, 0.864992082118988], "predator_velocity": [-0.09307053685188293, 0.16470922529697418]}, {"fish_idx": 52, "predator_index": 0, "fish_position": [-0.47300440073013306, 1.7569565773010254], "predator_position": [-0.4166224002838135, 1.6821062564849854], "predator_velocity": [0.6966865062713623, 2.507636547088623]}, {"fish_idx": 28, "predator_index": 0, "fish_position": [-2.657343864440918, -1.6349130868911743], "predator_position": [-2.1343889236450195, -1.3947831392288208], "predator_velocity": [-1.3844845294952393, 0.18155983090400696]}, {"fish_idx": 62, "predator_index": 0, "fish_position": [-2.725543260574341, -1.2807978391647339], "predator_position": [-2.1343889236450195, -1.3947831392288208], "predator_velocity": [-1.3844845294952393, 0.18155983090400696]}, {"fish_idx": 85, "predator_index": 0, "fish_position": [-2.5584378242492676, -1.8139606714248657], "predator_position": [-2.1343889236450195, -1.3947831392288208], "predator_velocity": [-1.3844845294952393, 0.18155983090400696]}, {"fish_idx": 5, "predator_index": 0, "fish_position": [-2.077402114868164, -1.3850255012512207], "predator_position": [-2.336608409881592, -0.7377360463142395], "predator_velocity": [-0.532706081867218, 0.631212055683136]}, {"fish_idx": 70, "predator_index": 0, "fish_position": [0.517831563949585, 2.291908025741577], "predator_position": [0.09903616458177567, 1.948354959487915], "predator_velocity": [0.2353382110595703, 1.7114295959472656]}, {"fish_idx": 81, "predator_index": 0, "fish_position": [-1.5146883726119995, 0.9913642406463623], "predator_position": [-1.8695952892303467, 1.1616030931472778], "predator_velocity": [-0.36744174361228943, 1.3977464437484741]}, {"fish_idx": 88, "predator_index": 0, "fish_position": [-1.6902755498886108, 0.6044020056724548], "predator_position": [-1.8695952892303467, 1.1616030931472778], "predator_velocity": [-0.36744174361228943, 1.3977464437484741]}, {"fish_idx": 51, "predator_index": 0, "fish_position": [-2.5336718559265137, -0.36485543847084045], "predator_position": [-2.015226364135742, 0.0028769224882125854], "predator_velocity": [-1.3161557912826538, 0.3170402944087982]}, {"fish_idx": 48, "predator_index": 0, "fish_position": [1.4919441938400269, 0.6171075105667114], "predator_position": [1.185570240020752, 0.5269166231155396], "predator_velocity": [0.5797194242477417, 1.4771525859832764]}, {"fish_idx": 68, "predator_index": 0, "fish_position": [1.7795213460922241, 0.4553297758102417], "predator_position": [1.185570240020752, 0.5269166231155396], "predator_velocity": [0.5797194242477417, 1.4771525859832764]}, {"fish_idx": 31, "predator_index": 0, "fish_position": [-1.9048545360565186, -0.5734897255897522], "predator_position": [-2.2525148391723633, -0.257306307554245], "predator_velocity": [-0.36787620186805725, 2.0219876766204834]}, {"fish_idx": 79, "predator_index": 0, "fish_position": [-1.8384629487991333, -0.5765078663825989], "predator_position": [-2.2525148391723633, -0.257306307554245], "predator_velocity": [-0.36787620186805725, 2.0219876766204834]}, {"fish_idx": 15, "predator_index": 0, "fish_position": [3.7029638290405273, -1.5658799409866333], "predator_position": [3.4256699085235596, -0.9288480281829834], "predator_velocity": [2.424006938934326, 0.08242492377758026]}, {"fish_idx": 22, "predator_index": 0, "fish_position": [3.3657798767089844, -0.42569321393966675], "predator_position": [3.4256699085235596, -0.9288480281829834], "predator_velocity": [2.424006938934326, 0.08242492377758026]}, {"fish_idx": 57, "predator_index": 0, "fish_position": [3.823765516281128, -1.085564136505127], "predator_position": [3.4256699085235596, -0.9288480281829834], "predator_velocity": [2.424006938934326, 0.08242492377758026]}, {"fish_idx": 66, "predator_index": 0, "fish_position": [3.7533376216888428, -0.5960482954978943], "predator_position": [3.4256699085235596, -0.9288480281829834], "predator_velocity": [2.424006938934326, 0.08242492377758026]}, {"fish_idx": 87, "predator_index": 0, "fish_position": [3.69476056098938, -0.8245717883110046], "predator_position": [3.4256699085235596, -0.9288480281829834], "predator_velocity": [2.424006938934326, 0.08242492377758026]}], "step_one_clusters": {"total": 31, "angle_bin_deg": 30.0, "speed_bin": 0.4, "clusters": [{"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 5, "share": 0.16129032258064516}, {"angle_deg_start": 0.0, "angle_deg_end": 30.0, "speed_bin_start": 2.4000000000000004, "speed_bin_end": 2.8000000000000003, "count": 5, "share": 0.16129032258064516}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 1.6, "speed_bin_end": 2.0, "count": 4, "share": 0.12903225806451613}, {"angle_deg_start": 150.0, "angle_deg_end": 180.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 4, "share": 0.12903225806451613}, {"angle_deg_start": 0.0, "angle_deg_end": 30.0, "speed_bin_start": 1.6, "speed_bin_end": 2.0, "count": 2, "share": 0.06451612903225806}, {"angle_deg_start": 150.0, "angle_deg_end": 180.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 2, "share": 0.06451612903225806}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 2, "share": 0.06451612903225806}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 2, "share": 0.06451612903225806}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 2.0, "speed_bin_end": 2.4000000000000004, "count": 2, "share": 0.06451612903225806}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 1, "share": 0.03225806451612903}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 2.4000000000000004, "speed_bin_end": 2.8000000000000003, "count": 1, "share": 0.03225806451612903}, {"angle_deg_start": 120.0, "angle_deg_end": 150.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 1, "share": 0.03225806451612903}]}, "step_one_ne_high_speed_share": 0.06451612903225806, "pre_roll_stats_summary": {"sampled_episodes": 16, "spawn_radius": {"count": 16, "mean": 0.6787143312394619, "std": 0.39157239711266334, "p10": 0.21148284524679184, "p50": 0.5620264708995819, "p90": 1.0796331763267517, "min": 0.06267373263835907, "max": 1.5775048732757568}, "spawn_angle_deg": {"count": 16, "mean": -32.106495440006256, "std": 97.4370358129524, "p10": -138.80062866210938, "p50": -41.08699321746826, "p90": 106.29041481018066, "min": -161.15975952148438, "max": 170.54266357421875}, "initial_heading_deg": {"count": 16, "mean": -29.312692999839783, "std": 99.20992475547777, "p10": -125.4066390991211, "p50": -82.6036491394043, "p90": 128.42488479614258, "min": -141.34104919433594, "max": 165.15914916992188}, "final_heading_deg": {"count": 16, "mean": 87.44897348806262, "std": 67.65009653504758, "p10": 12.362341493368149, "p50": 98.11195373535156, "p90": 166.09039306640625, "min": -100.64553833007812, "max": 174.57179260253906}, "initial_speed": {"count": 16, "mean": 1.5, "std": 5.960464477539063e-08, "p10": 1.4999999403953552, "p50": 1.5, "p90": 1.5000000596046448, "min": 1.4999998807907104, "max": 1.5000001192092896}, "final_speed": {"count": 16, "mean": 1.377341013867408, "std": 0.7026697761740156, "p10": 0.46806127578020096, "p50": 1.3938292860984802, "p90": 2.2151159048080444, "min": 0.04270850867033005, "max": 2.554476499557495}, "angle_jitter_deg": {"count": 256, "mean": -0.8851139222987126, "std": 9.769547673215968, "p10": -13.747715421914078, "p50": -1.6047699221001979, "p90": 12.41228844646315, "min": -17.18345393676071, "max": 17.1416914290722}, "speed_scale": {"count": 256, "mean": 2.6832145842346384, "std": 8.608452517346521, "p10": 0.20836499007058062, "p50": 1.0331606136665101, "p90": 4.522274757347981, "min": 0.0042783345872691335, "max": 99.7522731139596}, "heading_bias_angle_deg": {"count": 16, "mean": 195.68730542283726, "std": 96.49114672986286, "p10": 40.51736586870611, "p50": 234.5933588014272, "p90": 277.396347974076, "min": 7.903910621401127, "max": 326.10576920017024}, "prewarm_override_count": 0, "prewarm_override_ratio": 0.0, "spawn_angle_hist_deg": {"bins": [3, 1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0], "edges": [0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, 210.0, 240.0, 270.0, 300.0, 330.0, 360.0]}, "initial_speed_hist": {"bins": [0, 0, 0, 0, 0, 0, 0, 0, 0, 16], "edges": [0.0, 0.16, 0.32, 0.48, 0.64, 0.8, 0.96, 1.12, 1.28, 1.44, 1.6]}}, "penalty_gate": {"event": "locked", "stage": 0, "phase_limit": 3, "success_streak": 0, "freeze_until": 0, "failure_detected": false, "failure_streak": 0, "tail_stage_type": "ne", "early_death_threshold": 0.13, "step_one_death_ratio": 0.020182291666666668}}
{"iteration": 16, "timestamp": "2025-11-12T10:50:52.389374Z", "summary": {"episodes": 16, "avg_final_survival_rate": 0.7786458333333333, "min_final_survival_rate": 0.6875, "avg_min_survival_rate": 0.7786458333333333, "min_of_min_survival_rate": 0.6875, "median_min_survival_rate": 0.7864583333333333}, "death_stats": {"total_fish_samples": 1536, "survival_fraction": 0.7786458333333334, "mean_death_step": 427.71484375, "median_death_step": 500.0, "p10": 112.0, "p25": 500.0, "p75": 500.0, "p90": 500.0, "early_death_fraction_100": 0.091796875, "early_death_fraction_150": 0.12044270833333333}, "density_penalty_coef": 0.02, "escape_boost_speed": 0.75, "step_one_death_count": 27, "step_one_death_ratio": 0.017578125, "episode_seeds": [445253941, 428959627, 1020527185, 1691489846, 1120166328, 1896091936, 1164830179, 2083242502, 738018994, 1990562448, 519920504, 1872247923, 605400529, 1411260238, 1018197675, 308067299], "multi_eval_num_fish": 96, "multi_eval_episodes": 16, "tail_stage_label": "stage2:tail_seed_mix_v34_ne", "tail_stage_type": "ne", "tail_stage_remaining_by_type": {"ne": 384, "main": 12800}, "tail_stage_warn_active": false, "tail_stage_warn_since": null, "death_hist_path": "/Users/grapeot/co/fish_rl/experiments/v39/artifacts/plots/dev_v39_stageaware_gate_v1_longrun_multi_eval_hist/dev_v39_stageaware_gate_v1_longrun_iter016_death_hist.png", "step_one_deaths": [{"fish_idx": 4, "predator_index": 0, "fish_position": [1.3336697816848755, 2.971109390258789], "predator_position": [1.5456312894821167, 2.7135889530181885], "predator_velocity": [0.08686351031064987, 2.2969439029693604]}, {"fish_idx": 56, "predator_index": 0, "fish_position": [1.138798475265503, 2.1481635570526123], "predator_position": [1.5456312894821167, 2.7135889530181885], "predator_velocity": [0.08686351031064987, 2.2969439029693604]}, {"fish_idx": 17, "predator_index": 0, "fish_position": [-0.3143743872642517, 1.9260890483856201], "predator_position": [-0.6587538123130798, 1.8783159255981445], "predator_velocity": [0.4895246624946594, 1.5956735610961914]}, {"fish_idx": 41, "predator_index": 0, "fish_position": [-0.9116829633712769, 2.1031761169433594], "predator_position": [-0.6587538123130798, 1.8783159255981445], "predator_velocity": [0.4895246624946594, 1.5956735610961914]}, {"fish_idx": 47, "predator_index": 0, "fish_position": [-0.3796687126159668, 1.348745584487915], "predator_position": [-0.6587538123130798, 1.8783159255981445], "predator_velocity": [0.4895246624946594, 1.5956735610961914]}, {"fish_idx": 30, "predator_index": 0, "fish_position": [0.5494767427444458, 1.9148921966552734], "predator_position": [0.6468811631202698, 2.242039680480957], "predator_velocity": [0.05193238705396652, 1.7200521230697632]}, {"fish_idx": 50, "predator_index": 0, "fish_position": [0.5422741174697876, 2.2579495906829834], "predator_position": [0.6468811631202698, 2.242039680480957], "predator_velocity": [0.05193238705396652, 1.7200521230697632]}, {"fish_idx": 95, "predator_index": 0, "fish_position": [0.36570125818252563, 2.285486936569214], "predator_position": [0.6468811631202698, 2.242039680480957], "predator_velocity": [0.05193238705396652, 1.7200521230697632]}, {"fish_idx": 82, "predator_index": 0, "fish_position": [1.7882200479507446, -2.6922342777252197], "predator_position": [1.7606050968170166, -2.2073445320129395], "predator_velocity": [1.4614262580871582, 0.09778861701488495]}, {"fish_idx": 11, "predator_index": 0, "fish_position": [1.534123182296753, 0.9315236210823059], "predator_position": [1.3187029361724854, 1.4515951871871948], "predator_velocity": [-0.002321785781532526, 0.2833990156650543]}, {"fish_idx": 83, "predator_index": 0, "fish_position": [1.4144021272659302, 1.334663987159729], "predator_position": [1.3187029361724854, 1.4515951871871948], "predator_velocity": [-0.002321785781532526, 0.2833990156650543]}, {"fish_idx": 89, "predator_index": 0, "fish_position": [1.21872079372406, 1.7264248132705688], "predator_position": [1.3187029361724854, 1.4515951871871948], "predator_velocity": [-0.002321785781532526, 0.2833990156650543]}, {"fish_idx": 41, "predator_index": 0, "fish_position": [-3.147296667098999, 0.6671882271766663], "predator_position": [-2.5882415771484375, 0.27923959493637085], "predator_velocity": [-0.2714545428752899, 0.2262115180492401]}, {"fish_idx": 50, "predator_index": 0, "fish_position": [-2.042877197265625, 0.6526911854743958], "predator_position": [-2.5882415771484375, 0.27923959493637085], "predator_velocity": [-0.2714545428752899, 0.2262115180492401]}, {"fish_idx": 44, "predator_index": 0, "fish_position": [0.47348523139953613, 0.12889841198921204], "predator_position": [0.8780614137649536, 0.4308639168739319], "predator_velocity": [0.8150800466537476, 2.305192708969116]}, {"fish_idx": 52, "predator_index": 0, "fish_position": [0.5891454219818115, 1.0621110200881958], "predator_position": [0.8780614137649536, 0.4308639168739319], "predator_velocity": [0.8150800466537476, 2.305192708969116]}, {"fish_idx": 77, "predator_index": 0, "fish_position": [1.0716601610183716, 0.9299294352531433], "predator_position": [0.8780614137649536, 0.4308639168739319], "predator_velocity": [0.8150800466537476, 2.305192708969116]}, {"fish_idx": 92, "predator_index": 0, "fish_position": [0.27269378304481506, 0.198333740234375], "predator_position": [0.8780614137649536, 0.4308639168739319], "predator_velocity": [0.8150800466537476, 2.305192708969116]}, {"fish_idx": 94, "predator_index": 0, "fish_position": [0.44307056069374084, 0.13955806195735931], "predator_position": [0.8780614137649536, 0.4308639168739319], "predator_velocity": [0.8150800466537476, 2.305192708969116]}, {"fish_idx": 19, "predator_index": 0, "fish_position": [1.0362613201141357, 2.7147607803344727], "predator_position": [1.3196810483932495, 2.4655137062072754], "predator_velocity": [1.1871734857559204, 1.0016348361968994]}, {"fish_idx": 20, "predator_index": 0, "fish_position": [1.04691743850708, 3.0731968879699707], "predator_position": [1.3196810483932495, 2.4655137062072754], "predator_velocity": [1.1871734857559204, 1.0016348361968994]}, {"fish_idx": 69, "predator_index": 0, "fish_position": [0.7224788665771484, 2.4689154624938965], "predator_position": [1.3196810483932495, 2.4655137062072754], "predator_velocity": [1.1871734857559204, 1.0016348361968994]}, {"fish_idx": 78, "predator_index": 0, "fish_position": [0.767014741897583, 2.759493827819824], "predator_position": [1.3196810483932495, 2.4655137062072754], "predator_velocity": [1.1871734857559204, 1.0016348361968994]}, {"fish_idx": 76, "predator_index": 0, "fish_position": [0.7901670932769775, 0.05848776176571846], "predator_position": [0.8466408848762512, 0.6456372141838074], "predator_velocity": [-0.17332860827445984, 1.4600896835327148]}, {"fish_idx": 8, "predator_index": 0, "fish_position": [-1.7677404880523682, -0.6782544851303101], "predator_position": [-1.5503203868865967, -1.110044240951538], "predator_velocity": [-0.05881056562066078, 0.050469473004341125]}, {"fish_idx": 5, "predator_index": 0, "fish_position": [-1.8689048290252686, 0.31057649850845337], "predator_position": [-1.3478623628616333, 0.09716212749481201], "predator_velocity": [-0.7028402090072632, 1.7592780590057373]}, {"fish_idx": 25, "predator_index": 0, "fish_position": [-1.8520039319992065, -0.05773771554231644], "predator_position": [-1.3478623628616333, 0.09716212749481201], "predator_velocity": [-0.7028402090072632, 1.7592780590057373]}], "step_one_clusters": {"total": 27, "angle_bin_deg": 30.0, "speed_bin": 0.4, "clusters": [{"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 1.6, "speed_bin_end": 2.0, "count": 6, "share": 0.2222222222222222}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 2.4000000000000004, "speed_bin_end": 2.8000000000000003, "count": 5, "share": 0.18518518518518517}, {"angle_deg_start": 30.0, "angle_deg_end": 60.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 4, "share": 0.14814814814814814}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 3, "share": 0.1111111111111111}, {"angle_deg_start": 120.0, "angle_deg_end": 150.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 3, "share": 0.1111111111111111}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 2.0, "speed_bin_end": 2.4000000000000004, "count": 2, "share": 0.07407407407407407}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 1.6, "speed_bin_end": 2.0, "count": 2, "share": 0.07407407407407407}, {"angle_deg_start": 0.0, "angle_deg_end": 30.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 1, "share": 0.037037037037037035}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 1, "share": 0.037037037037037035}]}, "step_one_ne_high_speed_share": 0.07407407407407407, "pre_roll_stats_summary": {"sampled_episodes": 16, "spawn_radius": {"count": 16, "mean": 0.8552533891052008, "std": 0.5067611315996075, "p10": 0.25818830728530884, "p50": 0.8465719223022461, "p90": 1.498152494430542, "min": 0.012038618326187134, "max": 1.581760287284851}, "spawn_angle_deg": {"count": 16, "mean": -22.631897807121277, "std": 104.54798615120866, "p10": -147.7716293334961, "p50": 3.2582292556762695, "p90": 95.77836990356445, "min": -173.1353759765625, "max": 164.61669921875}, "initial_heading_deg": {"count": 16, "mean": -56.57013043947518, "std": 58.40703895007008, "p10": -124.90856552124023, "p50": -73.05566024780273, "p90": 26.946548461914062, "min": -144.85134887695312, "max": 42.475181579589844}, "final_heading_deg": {"count": 16, "mean": 56.666534535586834, "std": 79.69910976768256, "p10": -71.45807266235352, "p50": 86.80208969116211, "p90": 129.68143844604492, "min": -117.29569244384766, "max": 179.54261779785156}, "initial_speed": {"count": 16, "mean": 1.5000000074505806, "std": 5.10786071449596e-08, "p10": 1.5, "p50": 1.5, "p90": 1.5000000596046448, "min": 1.4999998807907104, "max": 1.5000001192092896}, "final_speed": {"count": 16, "mean": 1.328371417708695, "std": 0.7831702680877621, "p10": 0.2718057557940483, "p50": 1.4918582439422607, "p90": 2.3232951164245605, "min": 0.05881243944168091, "max": 2.724116325378418}, "angle_jitter_deg": {"count": 256, "mean": 1.1947915506210058, "std": 9.69411800897002, "p10": -12.046455269920017, "p50": 1.860905524960795, "p90": 14.636713426818194, "min": -17.124618473742903, "max": 17.166428701773842}, "speed_scale": {"count": 256, "mean": 2.4694686648441833, "std": 7.896040348601448, "p10": 0.22750554800822909, "p50": 0.9388805373288605, "p90": 3.3627903272924726, "min": 0.016416540615917487, "max": 95.42358703823388}, "heading_bias_angle_deg": {"count": 16, "mean": 190.92986572710902, "std": 116.34924689596, "p10": 18.83818823732007, "p50": 250.78768947130646, "p90": 292.36601051292155, "min": 0.43294952774813433, "max": 312.39198019611666}, "prewarm_override_count": 0, "prewarm_override_ratio": 0.0, "spawn_angle_hist_deg": {"bins": [1, 4, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0], "edges": [0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, 210.0, 240.0, 270.0, 300.0, 330.0, 360.0]}, "initial_speed_hist": {"bins": [0, 0, 0, 0, 0, 0, 0, 0, 0, 16], "edges": [0.0, 0.16, 0.32, 0.48, 0.64, 0.8, 0.96, 1.12, 1.28, 1.44, 1.6]}}, "penalty_gate": {"event": "locked", "stage": 0, "phase_limit": 3, "success_streak": 0, "freeze_until": 0, "failure_detected": false, "failure_streak": 0, "tail_stage_type": "ne", "early_death_threshold": 0.13, "step_one_death_ratio": 0.017578125}}
{"iteration": 24, "timestamp": "2025-11-12T10:57:25.781702Z", "summary": {"episodes": 16, "avg_final_survival_rate": 0.6985677083333333, "min_final_survival_rate": 0.5208333333333334, "avg_min_survival_rate": 0.6985677083333333, "min_of_min_survival_rate": 0.5208333333333334, "median_min_survival_rate": 0.6927083333333333}, "death_stats": {"total_fish_samples": 1536, "survival_fraction": 0.6985677083333334, "mean_death_step": 416.3255208333333, "median_death_step": 500.0, "p10": 109.0, "p25": 420.0, "p75": 500.0, "p90": 500.0, "early_death_fraction_100": 0.091796875, "early_death_fraction_150": 0.11328125}, "density_penalty_coef": 0.04, "escape_boost_speed": 0.76, "step_one_death_count": 35, "step_one_death_ratio": 0.022786458333333332, "episode_seeds": [625475757, 1242902654, 1587658396, 446394293, 1742049905, 294693601, 1476793083, 957065028, 1998182649, 1357749028, 1721031093, 2015809762, 2087113229, 813441757, 953344873, 879581534], "multi_eval_num_fish": 96, "multi_eval_episodes": 16, "tail_stage_label": "stage3:tail_seed_mix_v34_ne", "tail_stage_type": "main", "tail_stage_remaining_by_type": {"ne": 0, "main": 12672}, "tail_stage_warn_active": false, "tail_stage_warn_since": null, "death_hist_path": "/Users/grapeot/co/fish_rl/experiments/v39/artifacts/plots/dev_v39_stageaware_gate_v1_longrun_multi_eval_hist/dev_v39_stageaware_gate_v1_longrun_iter024_death_hist.png", "step_one_deaths": [{"fish_idx": 77, "predator_index": 0, "fish_position": [0.6681258082389832, 0.6444551944732666], "predator_position": [0.9401174783706665, 0.9677103757858276], "predator_velocity": [-0.4593188464641571, 1.1062599420547485]}, {"fish_idx": 71, "predator_index": 0, "fish_position": [-2.8750555515289307, -1.8864079713821411], "predator_position": [-2.855013370513916, -1.900613784790039], "predator_velocity": [-1.0106980800628662, -0.6082135438919067]}, {"fish_idx": 10, "predator_index": 0, "fish_position": [0.10684698820114136, 1.9986960887908936], "predator_position": [0.6524219512939453, 1.7013535499572754], "predator_velocity": [0.6477352380752563, 0.7980338335037231]}, {"fish_idx": 26, "predator_index": 0, "fish_position": [0.09037894010543823, 2.0047271251678467], "predator_position": [0.6524219512939453, 1.7013535499572754], "predator_velocity": [0.6477352380752563, 0.7980338335037231]}, {"fish_idx": 65, "predator_index": 0, "fish_position": [0.02853093296289444, -1.5098192691802979], "predator_position": [-0.060544777661561966, -1.5401188135147095], "predator_velocity": [0.02466689795255661, 0.08656957745552063]}, {"fish_idx": 9, "predator_index": 0, "fish_position": [-0.9650065898895264, 0.7679524421691895], "predator_position": [-0.939437210559845, 0.7516606450080872], "predator_velocity": [0.04255669191479683, 0.4266710877418518]}, {"fish_idx": 73, "predator_index": 0, "fish_position": [-1.2758886814117432, 0.6199891567230225], "predator_position": [-0.939437210559845, 0.7516606450080872], "predator_velocity": [0.04255669191479683, 0.4266710877418518]}, {"fish_idx": 87, "predator_index": 0, "fish_position": [-1.525420904159546, 0.8395269513130188], "predator_position": [-0.939437210559845, 0.7516606450080872], "predator_velocity": [0.04255669191479683, 0.4266710877418518]}, {"fish_idx": 20, "predator_index": 0, "fish_position": [-1.043835163116455, 1.3817603588104248], "predator_position": [-1.2842570543289185, 1.5164920091629028], "predator_velocity": [-0.1225738525390625, 1.805695652961731]}, {"fish_idx": 30, "predator_index": 0, "fish_position": [-0.22671854496002197, -0.2542518675327301], "predator_position": [-0.3156190514564514, -0.421308308839798], "predator_velocity": [-0.4927907884120941, -0.044673722237348557]}, {"fish_idx": 39, "predator_index": 0, "fish_position": [0.15642181038856506, 0.015711424872279167], "predator_position": [-0.3156190514564514, -0.421308308839798], "predator_velocity": [-0.4927907884120941, -0.044673722237348557]}, {"fish_idx": 45, "predator_index": 0, "fish_position": [0.10060198605060577, 0.1106356680393219], "predator_position": [-0.3156190514564514, -0.421308308839798], "predator_velocity": [-0.4927907884120941, -0.044673722237348557]}, {"fish_idx": 74, "predator_index": 0, "fish_position": [-0.626334011554718, -0.2555255889892578], "predator_position": [-0.3156190514564514, -0.421308308839798], "predator_velocity": [-0.4927907884120941, -0.044673722237348557]}, {"fish_idx": 80, "predator_index": 0, "fish_position": [-0.12626279890537262, 0.14095082879066467], "predator_position": [-0.3156190514564514, -0.421308308839798], "predator_velocity": [-0.4927907884120941, -0.044673722237348557]}, {"fish_idx": 88, "predator_index": 0, "fish_position": [0.19384068250656128, -0.0018342509865760803], "predator_position": [-0.3156190514564514, -0.421308308839798], "predator_velocity": [-0.4927907884120941, -0.044673722237348557]}, {"fish_idx": 8, "predator_index": 0, "fish_position": [-0.56109619140625, 0.21678724884986877], "predator_position": [-0.740821897983551, 0.012404650449752808], "predator_velocity": [-0.1570083647966385, 0.4754546582698822]}, {"fish_idx": 27, "predator_index": 0, "fish_position": [-0.501520037651062, -0.42821282148361206], "predator_position": [-0.740821897983551, 0.012404650449752808], "predator_velocity": [-0.1570083647966385, 0.4754546582698822]}, {"fish_idx": 42, "predator_index": 0, "fish_position": [-0.6750434637069702, -0.400070458650589], "predator_position": [-0.740821897983551, 0.012404650449752808], "predator_velocity": [-0.1570083647966385, 0.4754546582698822]}, {"fish_idx": 52, "predator_index": 0, "fish_position": [-1.038771152496338, 0.20390361547470093], "predator_position": [-0.740821897983551, 0.012404650449752808], "predator_velocity": [-0.1570083647966385, 0.4754546582698822]}, {"fish_idx": 80, "predator_index": 0, "fish_position": [-0.45864859223365784, -0.5638337731361389], "predator_position": [-0.740821897983551, 0.012404650449752808], "predator_velocity": [-0.1570083647966385, 0.4754546582698822]}, {"fish_idx": 8, "predator_index": 0, "fish_position": [0.30466586351394653, 0.618066668510437], "predator_position": [0.6629937887191772, 0.06700880080461502], "predator_velocity": [0.0843558982014656, 0.10047733783721924]}, {"fish_idx": 10, "predator_index": 0, "fish_position": [0.18283843994140625, -0.13670140504837036], "predator_position": [0.6629937887191772, 0.06700880080461502], "predator_velocity": [0.0843558982014656, 0.10047733783721924]}, {"fish_idx": 32, "predator_index": 0, "fish_position": [1.0139542818069458, -0.053826551884412766], "predator_position": [0.6629937887191772, 0.06700880080461502], "predator_velocity": [0.0843558982014656, 0.10047733783721924]}, {"fish_idx": 41, "predator_index": 0, "fish_position": [0.20815198123455048, 0.30698633193969727], "predator_position": [0.6629937887191772, 0.06700880080461502], "predator_velocity": [0.0843558982014656, 0.10047733783721924]}, {"fish_idx": 48, "predator_index": 0, "fish_position": [0.7948482632637024, 0.17337729036808014], "predator_position": [0.6629937887191772, 0.06700880080461502], "predator_velocity": [0.0843558982014656, 0.10047733783721924]}, {"fish_idx": 70, "predator_index": 0, "fish_position": [0.5600719451904297, 0.0016620242968201637], "predator_position": [0.6629937887191772, 0.06700880080461502], "predator_velocity": [0.0843558982014656, 0.10047733783721924]}, {"fish_idx": 80, "predator_index": 0, "fish_position": [0.36969348788261414, -0.4624062180519104], "predator_position": [0.6629937887191772, 0.06700880080461502], "predator_velocity": [0.0843558982014656, 0.10047733783721924]}, {"fish_idx": 67, "predator_index": 0, "fish_position": [-0.8741270303726196, 1.3247092962265015], "predator_position": [-0.8928378224372864, 1.049570918083191], "predator_velocity": [-0.08263833820819855, 0.2146153748035431]}, {"fish_idx": 61, "predator_index": 0, "fish_position": [-0.24772001802921295, 2.1024420261383057], "predator_position": [-0.20660468935966492, 2.3481390476226807], "predator_velocity": [-0.7106069326400757, 1.6325899362564087]}, {"fish_idx": 1, "predator_index": 0, "fish_position": [-0.13083191215991974, -1.3197399377822876], "predator_position": [0.316697359085083, -1.801727294921875], "predator_velocity": [0.14991343021392822, 0.9172186255455017]}, {"fish_idx": 33, "predator_index": 0, "fish_position": [1.9205070734024048, -0.3169557750225067], "predator_position": [2.162534475326538, 0.32091742753982544], "predator_velocity": [1.237033724784851, 0.4402884542942047]}, {"fish_idx": 36, "predator_index": 0, "fish_position": [0.7834075093269348, 1.8665595054626465], "predator_position": [0.12170746177434921, 1.6904972791671753], "predator_velocity": [0.09320879727602005, 0.3986758291721344]}, {"fish_idx": 55, "predator_index": 0, "fish_position": [-0.029376940801739693, 1.759628176689148], "predator_position": [0.12170746177434921, 1.6904972791671753], "predator_velocity": [0.09320879727602005, 0.3986758291721344]}, {"fish_idx": 81, "predator_index": 0, "fish_position": [0.2317706048488617, 1.8029983043670654], "predator_position": [0.12170746177434921, 1.6904972791671753], "predator_velocity": [0.09320879727602005, 0.3986758291721344]}, {"fish_idx": 3, "predator_index": 0, "fish_position": [-2.2044997215270996, -1.4542319774627686], "predator_position": [-1.6704732179641724, -1.309217095375061], "predator_velocity": [-1.8389124870300293, -1.0038354396820068]}], "step_one_clusters": {"total": 35, "angle_bin_deg": 30.0, "speed_bin": 0.4, "clusters": [{"angle_deg_start": 30.0, "angle_deg_end": 60.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 7, "share": 0.2}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 0.4, "speed_bin_end": 0.8, "count": 6, "share": 0.17142857142857143}, {"angle_deg_start": 180.0, "angle_deg_end": 210.0, "speed_bin_start": 0.4, "speed_bin_end": 0.8, "count": 6, "share": 0.17142857142857143}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.4, "speed_bin_end": 0.8, "count": 5, "share": 0.14285714285714285}, {"angle_deg_start": 30.0, "angle_deg_end": 60.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 2, "share": 0.05714285714285714}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 1.6, "speed_bin_end": 2.0, "count": 2, "share": 0.05714285714285714}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 1, "share": 0.02857142857142857}, {"angle_deg_start": 210.0, "angle_deg_end": 240.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 1, "share": 0.02857142857142857}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 1, "share": 0.02857142857142857}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 1, "share": 0.02857142857142857}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 1, "share": 0.02857142857142857}, {"angle_deg_start": 0.0, "angle_deg_end": 30.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 1, "share": 0.02857142857142857}, {"angle_deg_start": 180.0, "angle_deg_end": 210.0, "speed_bin_start": 2.0, "speed_bin_end": 2.4000000000000004, "count": 1, "share": 0.02857142857142857}]}, "step_one_ne_high_speed_share": 0.05714285714285714, "pre_roll_stats_summary": {"sampled_episodes": 16, "spawn_radius": {"count": 16, "mean": 0.5816864283988252, "std": 0.46414569345780926, "p10": 0.04841795563697815, "p50": 0.4275142401456833, "p90": 1.2593957781791687, "min": 0.02235461212694645, "max": 1.4008313417434692}, "spawn_angle_deg": {"count": 16, "mean": -11.355032444000244, "std": 107.15198633621267, "p10": -134.18206405639648, "p50": -35.041770935058594, "p90": 135.9920883178711, "min": -167.69813537597656, "max": 165.07177734375}, "initial_heading_deg": {"count": 16, "mean": -56.3090363740921, "std": 93.02287866085295, "p10": -158.16709899902344, "p50": -84.10340118408203, "p90": 78.52531814575195, "min": -173.1026153564453, "max": 112.88047790527344}, "final_heading_deg": {"count": 16, "mean": 35.101415395736694, "std": 95.84075122040295, "p10": -148.55499267578125, "p50": 77.61294937133789, "p90": 113.84140014648438, "min": -169.12496948242188, "max": 116.65704345703125}, "initial_speed": {"count": 16, "mean": 1.5, "std": 5.960464477539063e-08, "p10": 1.4999999403953552, "p50": 1.5, "p90": 1.5000000596046448, "min": 1.4999998807907104, "max": 1.5000001192092896}, "final_speed": {"count": 16, "mean": 0.8286346797831357, "std": 0.6430947045080929, "p10": 0.09782269969582558, "p50": 0.6909416913986206, "p90": 1.7473878264427185, "min": 0.04411110281944275, "max": 2.119473695755005}, "angle_jitter_deg": {"count": 256, "mean": 0.19770968414277557, "std": 9.563367096744757, "p10": -13.820370890298546, "p50": 0.12710826165568742, "p90": 13.657724897333628, "min": -17.042559175292336, "max": 17.036210310681316}, "speed_scale": {"count": 256, "mean": 2.0049753234793632, "std": 4.183222845416111, "p10": 0.19903188407727385, "p50": 0.9025571122310944, "p90": 3.5576550162639524, "min": 0.008388628359341508, "max": 41.672598459513615}, "heading_bias_angle_deg": {"count": 16, "mean": 191.19096137419004, "std": 90.15784199672213, "p10": 67.64329404585067, "p50": 208.78291500898303, "p90": 292.089103720313, "min": 16.32973858976353, "max": 308.7968761554114}, "prewarm_override_count": 0, "prewarm_override_ratio": 0.0, "spawn_angle_hist_deg": {"bins": [1, 0, 2, 1, 2, 1, 0, 0, 0, 0, 0, 0], "edges": [0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, 210.0, 240.0, 270.0, 300.0, 330.0, 360.0]}, "initial_speed_hist": {"bins": [0, 0, 0, 0, 0, 0, 0, 0, 0, 16], "edges": [0.0, 0.16, 0.32, 0.48, 0.64, 0.8, 0.96, 1.12, 1.28, 1.44, 1.6]}}, "penalty_gate": {"event": "locked", "stage": 0, "phase_limit": 3, "success_streak": 0, "freeze_until": 0, "failure_detected": false, "failure_streak": 0, "rolling_early_death_median": 0.091796875, "tail_stage_type": "main", "early_death_threshold": 0.1, "step_one_death_ratio": 0.022786458333333332}}
{"iteration": 32, "timestamp": "2025-11-12T11:04:09.331873Z", "summary": {"episodes": 16, "avg_final_survival_rate": 0.7669270833333334, "min_final_survival_rate": 0.625, "avg_min_survival_rate": 0.7669270833333334, "min_of_min_survival_rate": 0.625, "median_min_survival_rate": 0.765625}, "death_stats": {"total_fish_samples": 1536, "survival_fraction": 0.7669270833333334, "mean_death_step": 422.0872395833333, "median_death_step": 500.0, "p10": 108.0, "p25": 500.0, "p75": 500.0, "p90": 500.0, "early_death_fraction_100": 0.09375, "early_death_fraction_150": 0.12630208333333334}, "density_penalty_coef": 0.05, "escape_boost_speed": 0.78, "step_one_death_count": 28, "step_one_death_ratio": 0.018229166666666668, "episode_seeds": [1790440378, 1639549627, 879975675, 928837917, 2133624195, 1150798189, 911062971, 1137213038, 31902764, 1719158601, 1681169657, 1150370036, 1162494815, 1223074924, 1081308917, 1794553987], "multi_eval_num_fish": 96, "multi_eval_episodes": 16, "tail_stage_label": "stage3:tail_seed_mix_v34_ne", "tail_stage_type": "main", "tail_stage_remaining_by_type": {"ne": 0, "main": 11904}, "tail_stage_warn_active": false, "tail_stage_warn_since": null, "death_hist_path": "/Users/grapeot/co/fish_rl/experiments/v39/artifacts/plots/dev_v39_stageaware_gate_v1_longrun_multi_eval_hist/dev_v39_stageaware_gate_v1_longrun_iter032_death_hist.png", "step_one_deaths": [{"fish_idx": 50, "predator_index": 0, "fish_position": [-0.906613290309906, 0.26863938570022583], "predator_position": [-0.3890310227870941, 0.654130220413208], "predator_velocity": [-0.3652655780315399, 2.2481322288513184]}, {"fish_idx": 54, "predator_index": 0, "fish_position": [0.06259716302156448, 0.3516925275325775], "predator_position": [-0.3890310227870941, 0.654130220413208], "predator_velocity": [-0.3652655780315399, 2.2481322288513184]}, {"fish_idx": 80, "predator_index": 0, "fish_position": [0.20284421741962433, 0.5887572169303894], "predator_position": [-0.3890310227870941, 0.654130220413208], "predator_velocity": [-0.3652655780315399, 2.2481322288513184]}, {"fish_idx": 87, "predator_index": 0, "fish_position": [-0.3786170780658722, 0.19482070207595825], "predator_position": [-0.3890310227870941, 0.654130220413208], "predator_velocity": [-0.3652655780315399, 2.2481322288513184]}, {"fish_idx": 92, "predator_index": 0, "fish_position": [-0.43934929370880127, 1.1205997467041016], "predator_position": [-0.3890310227870941, 0.654130220413208], "predator_velocity": [-0.3652655780315399, 2.2481322288513184]}, {"fish_idx": 36, "predator_index": 0, "fish_position": [-3.0199220180511475, 1.617140531539917], "predator_position": [-2.554243326187134, 1.2528458833694458], "predator_velocity": [0.00948240701109171, 0.32422441244125366]}, {"fish_idx": 67, "predator_index": 0, "fish_position": [0.8110095262527466, 1.4908174276351929], "predator_position": [0.7128633260726929, 1.7927873134613037], "predator_velocity": [-1.0489813089370728, 2.306152582168579]}, {"fish_idx": 87, "predator_index": 0, "fish_position": [-0.5861510634422302, 1.5215933322906494], "predator_position": [-0.5313155651092529, 2.070964813232422], "predator_velocity": [-0.35000476241111755, 1.4234371185302734]}, {"fish_idx": 56, "predator_index": 0, "fish_position": [-0.1790364384651184, 0.9187965393066406], "predator_position": [0.20321808755397797, 1.3350344896316528], "predator_velocity": [1.3109766244888306, 0.7762112021446228]}, {"fish_idx": 16, "predator_index": 0, "fish_position": [-0.7250096201896667, 1.2520893812179565], "predator_position": [-0.8844546675682068, 1.2843393087387085], "predator_velocity": [-0.062443360686302185, 0.2986859977245331]}, {"fish_idx": 90, "predator_index": 0, "fish_position": [-1.1607919931411743, 1.61355459690094], "predator_position": [-0.8844546675682068, 1.2843393087387085], "predator_velocity": [-0.062443360686302185, 0.2986859977245331]}, {"fish_idx": 28, "predator_index": 0, "fish_position": [2.2216413021087646, 1.850443720817566], "predator_position": [2.156553268432617, 2.4486210346221924], "predator_velocity": [1.1506993770599365, 2.4990506172180176]}, {"fish_idx": 55, "predator_index": 0, "fish_position": [-3.1129097938537598, 1.3903149366378784], "predator_position": [-2.5926513671875, 1.3156112432479858], "predator_velocity": [-1.6443631649017334, 0.3469289243221283]}, {"fish_idx": 85, "predator_index": 0, "fish_position": [1.3777382373809814, 0.029462283477187157], "predator_position": [1.386915683746338, -0.33997446298599243], "predator_velocity": [1.441308617591858, 0.10676734149456024]}, {"fish_idx": 13, "predator_index": 0, "fish_position": [-0.6985728740692139, 1.7113629579544067], "predator_position": [-1.3246665000915527, 1.521270990371704], "predator_velocity": [-0.9157536625862122, 0.9056990742683411]}, {"fish_idx": 27, "predator_index": 0, "fish_position": [-0.8707728385925293, 1.204813838005066], "predator_position": [-1.3246665000915527, 1.521270990371704], "predator_velocity": [-0.9157536625862122, 0.9056990742683411]}, {"fish_idx": 58, "predator_index": 0, "fish_position": [-1.3195197582244873, 1.313042402267456], "predator_position": [-1.3246665000915527, 1.521270990371704], "predator_velocity": [-0.9157536625862122, 0.9056990742683411]}, {"fish_idx": 81, "predator_index": 0, "fish_position": [-1.1765410900115967, 0.8637735247612], "predator_position": [-1.3246665000915527, 1.521270990371704], "predator_velocity": [-0.9157536625862122, 0.9056990742683411]}, {"fish_idx": 87, "predator_index": 0, "fish_position": [-0.947060763835907, 1.1270830631256104], "predator_position": [-1.3246665000915527, 1.521270990371704], "predator_velocity": [-0.9157536625862122, 0.9056990742683411]}, {"fish_idx": 32, "predator_index": 0, "fish_position": [-1.8365466594696045, 0.8287568092346191], "predator_position": [-1.7834084033966064, 0.3231963515281677], "predator_velocity": [-2.2002079486846924, 1.3543635606765747]}, {"fish_idx": 37, "predator_index": 0, "fish_position": [-1.1645487546920776, 0.24816979467868805], "predator_position": [-1.7834084033966064, 0.3231963515281677], "predator_velocity": [-2.2002079486846924, 1.3543635606765747]}, {"fish_idx": 10, "predator_index": 0, "fish_position": [-0.1470789909362793, 2.3412158489227295], "predator_position": [0.4397847652435303, 2.308488607406616], "predator_velocity": [0.02727227844297886, 1.646498203277588]}, {"fish_idx": 51, "predator_index": 0, "fish_position": [0.14496411383152008, 2.806981086730957], "predator_position": [0.4397847652435303, 2.308488607406616], "predator_velocity": [0.02727227844297886, 1.646498203277588]}, {"fish_idx": 26, "predator_index": 0, "fish_position": [1.163350224494934, 1.3420840501785278], "predator_position": [1.3609129190444946, 0.9232053756713867], "predator_velocity": [2.310863494873047, 1.5939642190933228]}, {"fish_idx": 34, "predator_index": 0, "fish_position": [1.2071824073791504, 0.36000996828079224], "predator_position": [1.3609129190444946, 0.9232053756713867], "predator_velocity": [2.310863494873047, 1.5939642190933228]}, {"fish_idx": 56, "predator_index": 0, "fish_position": [1.3658089637756348, 0.9706928133964539], "predator_position": [1.3609129190444946, 0.9232053756713867], "predator_velocity": [2.310863494873047, 1.5939642190933228]}, {"fish_idx": 67, "predator_index": 0, "fish_position": [1.905066728591919, 1.2171847820281982], "predator_position": [1.3609129190444946, 0.9232053756713867], "predator_velocity": [2.310863494873047, 1.5939642190933228]}, {"fish_idx": 93, "predator_index": 0, "fish_position": [1.3759851455688477, 1.5217411518096924], "predator_position": [1.3609129190444946, 0.9232053756713867], "predator_velocity": [2.310863494873047, 1.5939642190933228]}], "step_one_clusters": {"total": 28, "angle_bin_deg": 30.0, "speed_bin": 0.4, "clusters": [{"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 2.0, "speed_bin_end": 2.4000000000000004, "count": 5, "share": 0.17857142857142858}, {"angle_deg_start": 120.0, "angle_deg_end": 150.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 5, "share": 0.17857142857142858}, {"angle_deg_start": 30.0, "angle_deg_end": 60.0, "speed_bin_start": 2.8000000000000003, "speed_bin_end": 3.2, "count": 5, "share": 0.17857142857142858}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 2, "share": 0.07142857142857142}, {"angle_deg_start": 120.0, "angle_deg_end": 150.0, "speed_bin_start": 2.4000000000000004, "speed_bin_end": 2.8000000000000003, "count": 2, "share": 0.07142857142857142}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 1.6, "speed_bin_end": 2.0, "count": 2, "share": 0.07142857142857142}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 1, "share": 0.03571428571428571}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 2.4000000000000004, "speed_bin_end": 2.8000000000000003, "count": 1, "share": 0.03571428571428571}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 1, "share": 0.03571428571428571}, {"angle_deg_start": 30.0, "angle_deg_end": 60.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 1, "share": 0.03571428571428571}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 2.4000000000000004, "speed_bin_end": 2.8000000000000003, "count": 1, "share": 0.03571428571428571}, {"angle_deg_start": 150.0, "angle_deg_end": 180.0, "speed_bin_start": 1.6, "speed_bin_end": 2.0, "count": 1, "share": 0.03571428571428571}, {"angle_deg_start": 0.0, "angle_deg_end": 30.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 1, "share": 0.03571428571428571}]}, "step_one_ne_high_speed_share": 0.2857142857142857, "pre_roll_stats_summary": {"sampled_episodes": 16, "spawn_radius": {"count": 16, "mean": 0.9443536541657522, "std": 0.4709558805738412, "p10": 0.24343571439385414, "p50": 1.0055877268314362, "p90": 1.4800269603729248, "min": 0.0299935732036829, "max": 1.5445711612701416}, "spawn_angle_deg": {"count": 16, "mean": 28.763765543699265, "std": 109.44454460244053, "p10": -135.6020965576172, "p50": 48.25301456451416, "p90": 160.9761734008789, "min": -158.59417724609375, "max": 175.58370971679688}, "initial_heading_deg": {"count": 16, "mean": -14.335788369178772, "std": 111.2001753478295, "p10": -142.01153564453125, "p50": -7.1477766036987305, "p90": 129.64837646484375, "min": -158.6672821044922, "max": 165.96548461914062}, "final_heading_deg": {"count": 16, "mean": 79.41474224627018, "std": 74.52593057342001, "p10": 15.61979877948761, "p50": 99.38323974609375, "p90": 144.611572265625, "min": -154.24925231933594, "max": 169.76417541503906}, "initial_speed": {"count": 16, "mean": 1.4999999925494194, "std": 5.10786071449596e-08, "p10": 1.4999999403953552, "p50": 1.5, "p90": 1.5, "min": 1.4999998807907104, "max": 1.5000001192092896}, "final_speed": {"count": 16, "mean": 1.589474462904036, "std": 0.8156538642810532, "p10": 0.26539699733257294, "p50": 1.5477057099342346, "p90": 2.6318498849868774, "min": 0.22276990115642548, "max": 2.77919340133667}, "angle_jitter_deg": {"count": 256, "mean": 0.564035274905658, "std": 9.790545283327331, "p10": -13.288718639444808, "p50": -0.04237979454787325, "p90": 13.855039659460804, "min": -17.130391705956022, "max": 17.07672657656393}, "speed_scale": {"count": 256, "mean": 1.8773253796004126, "std": 2.837342057868559, "p10": 0.1967825636637285, "p50": 0.9537704028560952, "p90": 4.418453582343904, "min": 0.01598334021494598, "max": 20.454212550739978}, "heading_bias_angle_deg": {"count": 16, "mean": 165.66421212738953, "std": 90.55159351031372, "p10": 47.13393776413682, "p50": 183.6491051456632, "p90": 264.2571576748586, "min": 16.331250464532026, "max": 329.37319619039386}, "prewarm_override_count": 0, "prewarm_override_ratio": 0.0, "spawn_angle_hist_deg": {"bins": [1, 0, 1, 4, 0, 3, 0, 0, 0, 0, 0, 0], "edges": [0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, 210.0, 240.0, 270.0, 300.0, 330.0, 360.0]}, "initial_speed_hist": {"bins": [0, 0, 0, 0, 0, 0, 0, 0, 0, 16], "edges": [0.0, 0.16, 0.32, 0.48, 0.64, 0.8, 0.96, 1.12, 1.28, 1.44, 1.6]}}, "penalty_gate": {"event": "noop", "stage": 0, "phase_limit": 3, "success_streak": 0, "freeze_until": 0, "failure_detected": false, "failure_streak": 0, "rolling_p10_median": 108.5, "rolling_early_death_median": 0.091796875, "tail_stage_type": "main", "early_death_threshold": 0.1, "step_one_death_ratio": 0.018229166666666668}}
{"iteration": 40, "timestamp": "2025-11-12T11:10:55.906472Z", "summary": {"episodes": 16, "avg_final_survival_rate": 0.791015625, "min_final_survival_rate": 0.6875, "avg_min_survival_rate": 0.791015625, "min_of_min_survival_rate": 0.6875, "median_min_survival_rate": 0.7916666666666666}, "death_stats": {"total_fish_samples": 1536, "survival_fraction": 0.791015625, "mean_death_step": 428.099609375, "median_death_step": 500.0, "p10": 106.0, "p25": 500.0, "p75": 500.0, "p90": 500.0, "early_death_fraction_100": 0.09244791666666667, "early_death_fraction_150": 0.12044270833333333}, "density_penalty_coef": 0.05, "escape_boost_speed": 0.8, "step_one_death_count": 32, "step_one_death_ratio": 0.020833333333333332, "episode_seeds": [1312387849, 1459441514, 1420870412, 684092528, 924584110, 619600097, 1248796816, 420756143, 125909319, 1149868295, 161469048, 1124404604, 252397794, 1744433341, 7965581, 682930222], "multi_eval_num_fish": 96, "multi_eval_episodes": 16, "tail_stage_label": "stage3:tail_seed_mix_v34_ne", "tail_stage_type": "main", "tail_stage_remaining_by_type": {"ne": 0, "main": 11264}, "tail_stage_warn_active": false, "tail_stage_warn_since": null, "death_hist_path": "/Users/grapeot/co/fish_rl/experiments/v39/artifacts/plots/dev_v39_stageaware_gate_v1_longrun_multi_eval_hist/dev_v39_stageaware_gate_v1_longrun_iter040_death_hist.png", "step_one_deaths": [{"fish_idx": 8, "predator_index": 0, "fish_position": [0.5866718292236328, 0.9966658353805542], "predator_position": [0.3263050317764282, 1.3790240287780762], "predator_velocity": [-0.49684232473373413, 1.468248724937439]}, {"fish_idx": 94, "predator_index": 0, "fish_position": [-0.07667265832424164, 0.9481520652770996], "predator_position": [0.3263050317764282, 1.3790240287780762], "predator_velocity": [-0.49684232473373413, 1.468248724937439]}, {"fish_idx": 44, "predator_index": 0, "fish_position": [-0.01103048212826252, 1.3701918125152588], "predator_position": [0.33757132291793823, 1.0379077196121216], "predator_velocity": [-0.7216232419013977, 0.9166086316108704]}, {"fish_idx": 58, "predator_index": 0, "fish_position": [0.1303192377090454, 1.5330777168273926], "predator_position": [0.33757132291793823, 1.0379077196121216], "predator_velocity": [-0.7216232419013977, 0.9166086316108704]}, {"fish_idx": 73, "predator_index": 0, "fish_position": [0.3513404130935669, 0.459693044424057], "predator_position": [0.33757132291793823, 1.0379077196121216], "predator_velocity": [-0.7216232419013977, 0.9166086316108704]}, {"fish_idx": 93, "predator_index": 0, "fish_position": [0.5660305619239807, 0.9560242295265198], "predator_position": [0.33757132291793823, 1.0379077196121216], "predator_velocity": [-0.7216232419013977, 0.9166086316108704]}, {"fish_idx": 19, "predator_index": 0, "fish_position": [1.0787557363510132, 1.9968345165252686], "predator_position": [1.5038529634475708, 2.4527273178100586], "predator_velocity": [0.3974369466304779, 2.2013609409332275]}, {"fish_idx": 62, "predator_index": 0, "fish_position": [-1.422027349472046, 0.14248190820217133], "predator_position": [-1.511125087738037, -0.06726416945457458], "predator_velocity": [-0.21973206102848053, 0.5427173972129822]}, {"fish_idx": 44, "predator_index": 0, "fish_position": [0.01871601678431034, -1.8293225765228271], "predator_position": [-0.4491939842700958, -1.6980470418930054], "predator_velocity": [-0.17139296233654022, -0.7209129929542542]}, {"fish_idx": 75, "predator_index": 0, "fish_position": [-0.2103174328804016, -1.0533784627914429], "predator_position": [-0.4491939842700958, -1.6980470418930054], "predator_velocity": [-0.17139296233654022, -0.7209129929542542]}, {"fish_idx": 3, "predator_index": 0, "fish_position": [-2.2915990352630615, 2.5976033210754395], "predator_position": [-2.2889695167541504, 2.0364303588867188], "predator_velocity": [-2.3723304271698, 0.8507262468338013]}, {"fish_idx": 14, "predator_index": 0, "fish_position": [-2.2889645099639893, 1.622773289680481], "predator_position": [-2.2889695167541504, 2.0364303588867188], "predator_velocity": [-2.3723304271698, 0.8507262468338013]}, {"fish_idx": 38, "predator_index": 0, "fish_position": [-2.3324780464172363, 2.3103291988372803], "predator_position": [-2.2889695167541504, 2.0364303588867188], "predator_velocity": [-2.3723304271698, 0.8507262468338013]}, {"fish_idx": 9, "predator_index": 0, "fish_position": [0.7956860661506653, -0.5524571537971497], "predator_position": [1.454866647720337, -0.48517629504203796], "predator_velocity": [2.3508925437927246, 0.6354590654373169]}, {"fish_idx": 25, "predator_index": 0, "fish_position": [1.0293593406677246, -0.40926459431648254], "predator_position": [1.454866647720337, -0.48517629504203796], "predator_velocity": [2.3508925437927246, 0.6354590654373169]}, {"fish_idx": 92, "predator_index": 0, "fish_position": [1.3299678564071655, -0.24459725618362427], "predator_position": [1.454866647720337, -0.48517629504203796], "predator_velocity": [2.3508925437927246, 0.6354590654373169]}, {"fish_idx": 20, "predator_index": 0, "fish_position": [1.5245118141174316, -2.672966718673706], "predator_position": [1.3097467422485352, -2.463144540786743], "predator_velocity": [0.9541123509407043, -0.45055514574050903]}, {"fish_idx": 34, "predator_index": 0, "fish_position": [1.1611918210983276, -1.9799590110778809], "predator_position": [1.3097467422485352, -2.463144540786743], "predator_velocity": [0.9541123509407043, -0.45055514574050903]}, {"fish_idx": 31, "predator_index": 0, "fish_position": [-3.07924222946167, -0.34915244579315186], "predator_position": [-2.6223208904266357, 0.07727925479412079], "predator_velocity": [-1.1073498725891113, 0.6505417227745056]}, {"fish_idx": 51, "predator_index": 0, "fish_position": [-2.475480794906616, -0.2617556154727936], "predator_position": [-2.6223208904266357, 0.07727925479412079], "predator_velocity": [-1.1073498725891113, 0.6505417227745056]}, {"fish_idx": 15, "predator_index": 0, "fish_position": [-1.2562425136566162, 1.1185951232910156], "predator_position": [-1.551574945449829, 1.1876417398452759], "predator_velocity": [-0.09103118628263474, 0.186623677611351]}, {"fish_idx": 94, "predator_index": 0, "fish_position": [-1.3749415874481201, 1.1804778575897217], "predator_position": [-1.551574945449829, 1.1876417398452759], "predator_velocity": [-0.09103118628263474, 0.186623677611351]}, {"fish_idx": 14, "predator_index": 0, "fish_position": [-0.14390259981155396, 1.0609378814697266], "predator_position": [-0.23140601813793182, 1.0082049369812012], "predator_velocity": [-0.032822269946336746, 0.5263159871101379]}, {"fish_idx": 39, "predator_index": 0, "fish_position": [-0.4527846574783325, 1.6457983255386353], "predator_position": [-0.23140601813793182, 1.0082049369812012], "predator_velocity": [-0.032822269946336746, 0.5263159871101379]}, {"fish_idx": 83, "predator_index": 0, "fish_position": [-0.21139590442180634, 0.9860325455665588], "predator_position": [-0.23140601813793182, 1.0082049369812012], "predator_velocity": [-0.032822269946336746, 0.5263159871101379]}, {"fish_idx": 86, "predator_index": 0, "fish_position": [-0.13899153470993042, 0.5898658037185669], "predator_position": [-0.23140601813793182, 1.0082049369812012], "predator_velocity": [-0.032822269946336746, 0.5263159871101379]}, {"fish_idx": 87, "predator_index": 0, "fish_position": [-0.1765359342098236, 1.250662088394165], "predator_position": [-0.23140601813793182, 1.0082049369812012], "predator_velocity": [-0.032822269946336746, 0.5263159871101379]}, {"fish_idx": 74, "predator_index": 0, "fish_position": [0.9051159024238586, -2.140395164489746], "predator_position": [0.5951288342475891, -2.557830810546875], "predator_velocity": [0.9891983866691589, -1.9209492206573486]}, {"fish_idx": 8, "predator_index": 0, "fish_position": [0.65097975730896, 1.5135239362716675], "predator_position": [1.1532648801803589, 1.94578218460083], "predator_velocity": [0.1091790571808815, 1.4086284637451172]}, {"fish_idx": 26, "predator_index": 0, "fish_position": [1.1708310842514038, 2.003875732421875], "predator_position": [1.1532648801803589, 1.94578218460083], "predator_velocity": [0.1091790571808815, 1.4086284637451172]}, {"fish_idx": 37, "predator_index": 0, "fish_position": [0.841547429561615, 1.5257843732833862], "predator_position": [1.1532648801803589, 1.94578218460083], "predator_velocity": [0.1091790571808815, 1.4086284637451172]}, {"fish_idx": 73, "predator_index": 0, "fish_position": [0.7689945101737976, 1.5727205276489258], "predator_position": [1.1532648801803589, 1.94578218460083], "predator_velocity": [0.1091790571808815, 1.4086284637451172]}], "step_one_clusters": {"total": 32, "angle_bin_deg": 30.0, "speed_bin": 0.4, "clusters": [{"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.4, "speed_bin_end": 0.8, "count": 6, "share": 0.1875}, {"angle_deg_start": 120.0, "angle_deg_end": 150.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 4, "share": 0.125}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 4, "share": 0.125}, {"angle_deg_start": 150.0, "angle_deg_end": 180.0, "speed_bin_start": 2.4000000000000004, "speed_bin_end": 2.8000000000000003, "count": 3, "share": 0.09375}, {"angle_deg_start": 0.0, "angle_deg_end": 30.0, "speed_bin_start": 2.4000000000000004, "speed_bin_end": 2.8000000000000003, "count": 3, "share": 0.09375}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 2, "share": 0.0625}, {"angle_deg_start": 240.0, "angle_deg_end": 270.0, "speed_bin_start": 0.4, "speed_bin_end": 0.8, "count": 2, "share": 0.0625}, {"angle_deg_start": 330.0, "angle_deg_end": 360.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 2, "share": 0.0625}, {"angle_deg_start": 120.0, "angle_deg_end": 150.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 2, "share": 0.0625}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 2, "share": 0.0625}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 2.0, "speed_bin_end": 2.4000000000000004, "count": 1, "share": 0.03125}, {"angle_deg_start": 270.0, "angle_deg_end": 300.0, "speed_bin_start": 2.0, "speed_bin_end": 2.4000000000000004, "count": 1, "share": 0.03125}]}, "step_one_ne_high_speed_share": 0.0, "pre_roll_stats_summary": {"sampled_episodes": 16, "spawn_radius": {"count": 16, "mean": 0.674550115596503, "std": 0.3387472996281888, "p10": 0.2257074937224388, "p50": 0.712373286485672, "p90": 1.0543605089187622, "min": 0.12144125252962112, "max": 1.345396637916565}, "spawn_angle_deg": {"count": 16, "mean": -4.063762903213501, "std": 87.09048333834939, "p10": -107.15039443969727, "p50": -6.5396528244018555, "p90": 120.38973999023438, "min": -126.33477783203125, "max": 142.59217834472656}, "initial_heading_deg": {"count": 16, "mean": -55.18708914518356, "std": 97.37072720743377, "p10": -141.55635833740234, "p50": -89.65164947509766, "p90": 72.00204658508301, "min": -170.4347381591797, "max": 170.67745971679688}, "final_heading_deg": {"count": 16, "mean": 76.87158238887787, "std": 76.9408187597202, "p10": -45.51560974121094, "p50": 101.62417984008789, "p90": 146.46017456054688, "min": -102.53439331054688, "max": 161.3490447998047}, "initial_speed": {"count": 16, "mean": 1.5, "std": 5.960464477539063e-08, "p10": 1.4999999403953552, "p50": 1.5, "p90": 1.5000000596046448, "min": 1.4999998807907104, "max": 1.5000001192092896}, "final_speed": {"count": 16, "mean": 1.2556764781475067, "std": 0.7633502706620972, "p10": 0.3404375910758972, "p50": 1.193715512752533, "p90": 2.313976287841797, "min": 0.16417279839515686, "max": 2.5038199424743652}, "angle_jitter_deg": {"count": 256, "mean": 0.020027653441823112, "std": 9.861340486084158, "p10": -13.45891220834599, "p50": 0.29615927935398345, "p90": 13.842937255052055, "min": -17.020603103714713, "max": 17.176514315379702}, "speed_scale": {"count": 256, "mean": 2.326066707502017, "std": 4.775918047517155, "p10": 0.20506857006225937, "p50": 0.9983977184203972, "p90": 4.310749815612106, "min": 0.001363845212996123, "max": 34.05869088936066}, "heading_bias_angle_deg": {"count": 16, "mean": 192.31290770631458, "std": 87.6382739456056, "p10": 58.21450697442241, "p50": 222.317390374591, "p90": 281.7642033376315, "min": 12.007344218014815, "max": 294.9624139763495}, "prewarm_override_count": 0, "prewarm_override_ratio": 0.0, "spawn_angle_hist_deg": {"bins": [1, 3, 1, 1, 2, 0, 0, 0, 0, 0, 0, 0], "edges": [0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, 210.0, 240.0, 270.0, 300.0, 330.0, 360.0]}, "initial_speed_hist": {"bins": [0, 0, 0, 0, 0, 0, 0, 0, 0, 16], "edges": [0.0, 0.16, 0.32, 0.48, 0.64, 0.8, 0.96, 1.12, 1.28, 1.44, 1.6]}}, "penalty_gate": {"event": "noop", "stage": 0, "phase_limit": 3, "success_streak": 0, "freeze_until": 0, "failure_detected": false, "failure_streak": 0, "rolling_p10_median": 108.5, "rolling_early_death_median": 0.09244791666666667, "rolling_early_death_median_stage": 0.09244791666666667, "tail_stage_type": "main", "early_death_threshold": 0.1, "step_one_death_ratio": 0.020833333333333332}}
{"iteration": 48, "timestamp": "2025-11-12T11:17:35.122655Z", "summary": {"episodes": 16, "avg_final_survival_rate": 0.763671875, "min_final_survival_rate": 0.53125, "avg_min_survival_rate": 0.763671875, "min_of_min_survival_rate": 0.53125, "median_min_survival_rate": 0.7708333333333334}, "death_stats": {"total_fish_samples": 1536, "survival_fraction": 0.7643229166666666, "mean_death_step": 416.5826822916667, "median_death_step": 500.0, "p10": 82.5, "p25": 500.0, "p75": 500.0, "p90": 500.0, "early_death_fraction_100": 0.111328125, "early_death_fraction_150": 0.14127604166666666}, "density_penalty_coef": 0.05, "escape_boost_speed": 0.8, "step_one_death_count": 46, "step_one_death_ratio": 0.029947916666666668, "episode_seeds": [848573024, 999370333, 1157335068, 2083629807, 50337040, 1211461844, 1057963650, 690389743, 1974920555, 2123561028, 1212114194, 179268077, 446795994, 58527984, 1358012688, 81693825], "multi_eval_num_fish": 96, "multi_eval_episodes": 16, "tail_stage_label": "stage4:tail_seed_mix_v32_stage1", "tail_stage_type": "main", "tail_stage_remaining_by_type": {"ne": 0, "main": 10624}, "tail_stage_warn_active": false, "tail_stage_warn_since": null, "death_hist_path": "/Users/grapeot/co/fish_rl/experiments/v39/artifacts/plots/dev_v39_stageaware_gate_v1_longrun_multi_eval_hist/dev_v39_stageaware_gate_v1_longrun_iter048_death_hist.png", "step_one_deaths": [{"fish_idx": 29, "predator_index": 0, "fish_position": [-1.0835555791854858, 1.7094030380249023], "predator_position": [-1.1495836973190308, 1.6647064685821533], "predator_velocity": [-0.8247129917144775, 0.9822924733161926]}, {"fish_idx": 8, "predator_index": 0, "fish_position": [-2.2975683212280273, -0.21087536215782166], "predator_position": [-2.1038646697998047, 0.20882341265678406], "predator_velocity": [-1.6898508071899414, 1.6099203824996948]}, {"fish_idx": 23, "predator_index": 0, "fish_position": [0.44871827960014343, 0.8835021257400513], "predator_position": [0.23110631108283997, 0.5076812505722046], "predator_velocity": [0.1694478988647461, 1.648772120475769]}, {"fish_idx": 37, "predator_index": 0, "fish_position": [-0.2068970501422882, -0.03258180990815163], "predator_position": [0.23110631108283997, 0.5076812505722046], "predator_velocity": [0.1694478988647461, 1.648772120475769]}, {"fish_idx": 52, "predator_index": 0, "fish_position": [0.6586988568305969, 0.8058183193206787], "predator_position": [0.23110631108283997, 0.5076812505722046], "predator_velocity": [0.1694478988647461, 1.648772120475769]}, {"fish_idx": 60, "predator_index": 0, "fish_position": [0.166434645652771, 0.5544804930686951], "predator_position": [0.23110631108283997, 0.5076812505722046], "predator_velocity": [0.1694478988647461, 1.648772120475769]}, {"fish_idx": 68, "predator_index": 0, "fish_position": [0.5507672429084778, 0.7551586031913757], "predator_position": [0.23110631108283997, 0.5076812505722046], "predator_velocity": [0.1694478988647461, 1.648772120475769]}, {"fish_idx": 74, "predator_index": 0, "fish_position": [0.3311585783958435, 0.1260376125574112], "predator_position": [0.23110631108283997, 0.5076812505722046], "predator_velocity": [0.1694478988647461, 1.648772120475769]}, {"fish_idx": 79, "predator_index": 0, "fish_position": [0.10792677104473114, -0.16806605458259583], "predator_position": [0.23110631108283997, 0.5076812505722046], "predator_velocity": [0.1694478988647461, 1.648772120475769]}, {"fish_idx": 9, "predator_index": 0, "fish_position": [0.254081666469574, 0.9980579018592834], "predator_position": [0.39850425720214844, 1.5668401718139648], "predator_velocity": [0.05676230415701866, 1.1203837394714355]}, {"fish_idx": 20, "predator_index": 0, "fish_position": [0.32114937901496887, 1.0356534719467163], "predator_position": [0.39850425720214844, 1.5668401718139648], "predator_velocity": [0.05676230415701866, 1.1203837394714355]}, {"fish_idx": 67, "predator_index": 0, "fish_position": [0.4212677478790283, 0.9747613668441772], "predator_position": [0.39850425720214844, 1.5668401718139648], "predator_velocity": [0.05676230415701866, 1.1203837394714355]}, {"fish_idx": 68, "predator_index": 0, "fish_position": [0.4478698670864105, 1.4034736156463623], "predator_position": [0.39850425720214844, 1.5668401718139648], "predator_velocity": [0.05676230415701866, 1.1203837394714355]}, {"fish_idx": 91, "predator_index": 0, "fish_position": [0.5287250280380249, 1.927879810333252], "predator_position": [0.39850425720214844, 1.5668401718139648], "predator_velocity": [0.05676230415701866, 1.1203837394714355]}, {"fish_idx": 8, "predator_index": 0, "fish_position": [0.3409823775291443, 0.05483105406165123], "predator_position": [0.4545653462409973, 0.1366216242313385], "predator_velocity": [0.024387042969465256, 0.23090657591819763]}, {"fish_idx": 22, "predator_index": 0, "fish_position": [0.6331402063369751, -0.45768603682518005], "predator_position": [0.4545653462409973, 0.1366216242313385], "predator_velocity": [0.024387042969465256, 0.23090657591819763]}, {"fish_idx": 33, "predator_index": 0, "fish_position": [0.3992880582809448, 0.2591782510280609], "predator_position": [0.4545653462409973, 0.1366216242313385], "predator_velocity": [0.024387042969465256, 0.23090657591819763]}, {"fish_idx": 35, "predator_index": 0, "fish_position": [1.0269986391067505, 0.22312425076961517], "predator_position": [0.4545653462409973, 0.1366216242313385], "predator_velocity": [0.024387042969465256, 0.23090657591819763]}, {"fish_idx": 53, "predator_index": 0, "fish_position": [0.1097785234451294, 0.6085457801818848], "predator_position": [0.4545653462409973, 0.1366216242313385], "predator_velocity": [0.024387042969465256, 0.23090657591819763]}, {"fish_idx": 63, "predator_index": 0, "fish_position": [0.5613276362419128, 0.03678164631128311], "predator_position": [0.4545653462409973, 0.1366216242313385], "predator_velocity": [0.024387042969465256, 0.23090657591819763]}, {"fish_idx": 12, "predator_index": 0, "fish_position": [0.3013942241668701, 0.8483291864395142], "predator_position": [-0.0478479266166687, 0.5106141567230225], "predator_velocity": [-1.9697821140289307, 2.0514750480651855]}, {"fish_idx": 23, "predator_index": 0, "fish_position": [0.06452474743127823, 0.4451460838317871], "predator_position": [-0.0478479266166687, 0.5106141567230225], "predator_velocity": [-1.9697821140289307, 2.0514750480651855]}, {"fish_idx": 32, "predator_index": 0, "fish_position": [-0.47591716051101685, -0.01987018994987011], "predator_position": [-0.0478479266166687, 0.5106141567230225], "predator_velocity": [-1.9697821140289307, 2.0514750480651855]}, {"fish_idx": 42, "predator_index": 0, "fish_position": [-0.44142580032348633, 0.22681479156017303], "predator_position": [-0.0478479266166687, 0.5106141567230225], "predator_velocity": [-1.9697821140289307, 2.0514750480651855]}, {"fish_idx": 57, "predator_index": 0, "fish_position": [-0.18085923790931702, 0.5295865535736084], "predator_position": [-0.0478479266166687, 0.5106141567230225], "predator_velocity": [-1.9697821140289307, 2.0514750480651855]}, {"fish_idx": 83, "predator_index": 0, "fish_position": [0.038348689675331116, -0.17204633355140686], "predator_position": [-0.0478479266166687, 0.5106141567230225], "predator_velocity": [-1.9697821140289307, 2.0514750480651855]}, {"fish_idx": 84, "predator_index": 0, "fish_position": [0.20739859342575073, 0.11379788815975189], "predator_position": [-0.0478479266166687, 0.5106141567230225], "predator_velocity": [-1.9697821140289307, 2.0514750480651855]}, {"fish_idx": 39, "predator_index": 0, "fish_position": [-3.1480932235717773, 2.406423807144165], "predator_position": [-2.678036689758301, 2.491319179534912], "predator_velocity": [-1.042008638381958, 1.776616096496582]}, {"fish_idx": 57, "predator_index": 0, "fish_position": [-0.5219531059265137, 2.0256121158599854], "predator_position": [-1.030139446258545, 1.863316297531128], "predator_velocity": [-0.10099498182535172, 0.48309648036956787]}, {"fish_idx": 26, "predator_index": 0, "fish_position": [-0.3082253336906433, 0.6201128363609314], "predator_position": [-0.5565221309661865, 0.42952075600624084], "predator_velocity": [-0.04976918175816536, 1.1606167554855347]}, {"fish_idx": 52, "predator_index": 0, "fish_position": [-0.3438397943973541, -0.04846740886569023], "predator_position": [-0.5565221309661865, 0.42952075600624084], "predator_velocity": [-0.04976918175816536, 1.1606167554855347]}, {"fish_idx": 56, "predator_index": 0, "fish_position": [-0.7333874702453613, 0.9706918001174927], "predator_position": [-0.5565221309661865, 0.42952075600624084], "predator_velocity": [-0.04976918175816536, 1.1606167554855347]}, {"fish_idx": 58, "predator_index": 0, "fish_position": [-1.3765966892242432, -0.5931942462921143], "predator_position": [-1.386879563331604, -0.3176293969154358], "predator_velocity": [-1.1831738948822021, 0.45790383219718933]}, {"fish_idx": 7, "predator_index": 0, "fish_position": [0.5659385323524475, 1.8547821044921875], "predator_position": [0.6971184611320496, 1.4780274629592896], "predator_velocity": [1.0425540208816528, 0.8491690754890442]}, {"fish_idx": 42, "predator_index": 0, "fish_position": [0.44387903809547424, 1.1596319675445557], "predator_position": [0.6971184611320496, 1.4780274629592896], "predator_velocity": [1.0425540208816528, 0.8491690754890442]}, {"fish_idx": 57, "predator_index": 0, "fish_position": [0.6199149489402771, 0.8462376594543457], "predator_position": [0.6971184611320496, 1.4780274629592896], "predator_velocity": [1.0425540208816528, 0.8491690754890442]}, {"fish_idx": 7, "predator_index": 0, "fish_position": [1.2273496389389038, 0.6881647109985352], "predator_position": [0.7295533418655396, 0.9950991868972778], "predator_velocity": [0.46594926714897156, 0.8493516445159912]}, {"fish_idx": 20, "predator_index": 0, "fish_position": [0.6743768453598022, 1.2045706510543823], "predator_position": [0.7295533418655396, 0.9950991868972778], "predator_velocity": [0.46594926714897156, 0.8493516445159912]}, {"fish_idx": 22, "predator_index": 0, "fish_position": [0.8733488917350769, 0.688949704170227], "predator_position": [0.7295533418655396, 0.9950991868972778], "predator_velocity": [0.46594926714897156, 0.8493516445159912]}, {"fish_idx": 30, "predator_index": 0, "fish_position": [0.6709638833999634, 1.530174732208252], "predator_position": [0.7295533418655396, 0.9950991868972778], "predator_velocity": [0.46594926714897156, 0.8493516445159912]}, {"fish_idx": 4, "predator_index": 0, "fish_position": [-0.5972590446472168, 2.510798692703247], "predator_position": [-0.5251139402389526, 2.1013128757476807], "predator_velocity": [0.05910094082355499, 0.3102259635925293]}, {"fish_idx": 34, "predator_index": 0, "fish_position": [-0.01724272035062313, 2.2325797080993652], "predator_position": [-0.5251139402389526, 2.1013128757476807], "predator_velocity": [0.05910094082355499, 0.3102259635925293]}, {"fish_idx": 37, "predator_index": 0, "fish_position": [-0.36038440465927124, 0.39118140935897827], "predator_position": [-0.47717931866645813, 0.26769930124282837], "predator_velocity": [-0.8896734714508057, 1.0922646522521973]}, {"fish_idx": 42, "predator_index": 0, "fish_position": [-0.04120813310146332, -0.23253756761550903], "predator_position": [-0.47717931866645813, 0.26769930124282837], "predator_velocity": [-0.8896734714508057, 1.0922646522521973]}, {"fish_idx": 58, "predator_index": 0, "fish_position": [-1.0065253973007202, -0.11305588483810425], "predator_position": [-0.47717931866645813, 0.26769930124282837], "predator_velocity": [-0.8896734714508057, 1.0922646522521973]}, {"fish_idx": 88, "predator_index": 0, "fish_position": [-0.04799294099211693, 0.14643949270248413], "predator_position": [-0.47717931866645813, 0.26769930124282837], "predator_velocity": [-0.8896734714508057, 1.0922646522521973]}], "step_one_clusters": {"total": 46, "angle_bin_deg": 30.0, "speed_bin": 0.4, "clusters": [{"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 9, "share": 0.1956521739130435}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 8, "share": 0.17391304347826086}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 1.6, "speed_bin_end": 2.0, "count": 7, "share": 0.15217391304347827}, {"angle_deg_start": 120.0, "angle_deg_end": 150.0, "speed_bin_start": 2.8000000000000003, "speed_bin_end": 3.2, "count": 7, "share": 0.15217391304347827}, {"angle_deg_start": 120.0, "angle_deg_end": 150.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 5, "share": 0.10869565217391304}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 3, "share": 0.06521739130434782}, {"angle_deg_start": 30.0, "angle_deg_end": 60.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 3, "share": 0.06521739130434782}, {"angle_deg_start": 120.0, "angle_deg_end": 150.0, "speed_bin_start": 2.0, "speed_bin_end": 2.4000000000000004, "count": 2, "share": 0.043478260869565216}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.4, "speed_bin_end": 0.8, "count": 1, "share": 0.021739130434782608}, {"angle_deg_start": 150.0, "angle_deg_end": 180.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 1, "share": 0.021739130434782608}]}, "step_one_ne_high_speed_share": 0.1956521739130435, "pre_roll_stats_summary": {"sampled_episodes": 16, "spawn_radius": {"count": 16, "mean": 0.8975881692022085, "std": 0.4259864681317111, "p10": 0.34004373848438263, "p50": 0.7985292971134186, "p90": 1.4476407170295715, "min": 0.3161587715148926, "max": 1.5649102926254272}, "spawn_angle_deg": {"count": 16, "mean": -51.75687766075134, "std": 90.11511236528315, "p10": -159.3228759765625, "p50": -73.43572998046875, "p90": 63.912010192871094, "min": -170.8075714111328, "max": 133.72412109375}, "initial_heading_deg": {"count": 16, "mean": 3.4464714527130127, "std": 107.8681722508922, "p10": -140.59503555297852, "p50": 40.55816841125488, "p90": 126.80978012084961, "min": -177.7082061767578, "max": 171.99310302734375}, "final_heading_deg": {"count": 16, "mean": 93.9688948392868, "std": 38.85813343509135, "p10": 35.344505310058594, "p50": 89.76513671875, "p90": 135.91614532470703, "min": 31.01651954650879, "max": 160.97816467285156}, "initial_speed": {"count": 16, "mean": 1.5000000074505806, "std": 5.10786071449596e-08, "p10": 1.5, "p50": 1.5, "p90": 1.5000000596046448, "min": 1.4999998807907104, "max": 1.5000001192092896}, "final_speed": {"count": 16, "mean": 1.2811232469975948, "std": 0.6998284197691357, "p10": 0.3557845652103424, "p50": 1.2481153011322021, "p90": 2.1582239866256714, "min": 0.18254292011260986, "max": 2.808192253112793}, "angle_jitter_deg": {"count": 256, "mean": 0.01511081985376353, "std": 9.501131050011782, "p10": -12.817536866100982, "p50": 0.014943144782825574, "p90": 13.29817792698951, "min": -16.781197064116327, "max": 17.14365616245007}, "speed_scale": {"count": 256, "mean": 2.062199839604034, "std": 3.445093814791487, "p10": 0.19342472027055643, "p50": 0.9249668095638756, "p90": 5.230183989085859, "min": 0.0037458904383029443, "max": 23.49040136331245}, "heading_bias_angle_deg": {"count": 16, "mean": 160.94647194695617, "std": 95.84845247632673, "p10": 65.61198602000913, "p50": 167.91402875449666, "p90": 292.24872150786445, "min": 18.907654264887817, "max": 327.5826209567682}, "prewarm_override_count": 0, "prewarm_override_ratio": 0.0, "spawn_angle_hist_deg": {"bins": [0, 3, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0], "edges": [0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, 210.0, 240.0, 270.0, 300.0, 330.0, 360.0]}, "initial_speed_hist": {"bins": [0, 0, 0, 0, 0, 0, 0, 0, 0, 16], "edges": [0.0, 0.16, 0.32, 0.48, 0.64, 0.8, 0.96, 1.12, 1.28, 1.44, 1.6]}}, "penalty_gate": {"event": "failure_hold", "stage": 0, "phase_limit": 3, "success_streak": 0, "freeze_until": 53, "failure_detected": true, "failure_streak": 1, "rolling_p10_median": 107.0, "rolling_early_death_median": 0.09375, "rolling_early_death_median_stage": 0.09375, "tail_stage_type": "main", "early_death_threshold": 0.1, "step_one_death_ratio": 0.029947916666666668}}
{"iteration": 56, "timestamp": "2025-11-12T11:24:15.238755Z", "summary": {"episodes": 16, "avg_final_survival_rate": 0.78515625, "min_final_survival_rate": 0.6145833333333334, "avg_min_survival_rate": 0.78515625, "min_of_min_survival_rate": 0.6145833333333334, "median_min_survival_rate": 0.7708333333333333}, "death_stats": {"total_fish_samples": 1536, "survival_fraction": 0.78515625, "mean_death_step": 421.970703125, "median_death_step": 500.0, "p10": 99.0, "p25": 500.0, "p75": 500.0, "p90": 500.0, "early_death_fraction_100": 0.10026041666666667, "early_death_fraction_150": 0.13932291666666666}, "density_penalty_coef": 0.05, "escape_boost_speed": 0.8, "step_one_death_count": 31, "step_one_death_ratio": 0.020182291666666668, "episode_seeds": [409076502, 1210897055, 1212637918, 901154816, 886793816, 2024270640, 2081125602, 386802137, 2899864, 462919196, 830483834, 225437769, 1215054589, 1275363252, 1581441085, 1552529024], "multi_eval_num_fish": 96, "multi_eval_episodes": 16, "tail_stage_label": "stage4:tail_seed_mix_v32_stage1", "tail_stage_type": "main", "tail_stage_remaining_by_type": {"ne": 0, "main": 9984}, "tail_stage_warn_active": false, "tail_stage_warn_since": null, "death_hist_path": "/Users/grapeot/co/fish_rl/experiments/v39/artifacts/plots/dev_v39_stageaware_gate_v1_longrun_multi_eval_hist/dev_v39_stageaware_gate_v1_longrun_iter056_death_hist.png", "step_one_deaths": [{"fish_idx": 55, "predator_index": 0, "fish_position": [0.7807159423828125, -0.7726836204528809], "predator_position": [0.5554095506668091, -1.1734830141067505], "predator_velocity": [1.9424158334732056, 0.20525217056274414]}, {"fish_idx": 72, "predator_index": 0, "fish_position": [0.4545786678791046, -0.714799702167511], "predator_position": [0.5554095506668091, -1.1734830141067505], "predator_velocity": [1.9424158334732056, 0.20525217056274414]}, {"fish_idx": 17, "predator_index": 0, "fish_position": [-2.4162187576293945, 0.08667859435081482], "predator_position": [-1.8106086254119873, 0.04909985885024071], "predator_velocity": [-0.16356708109378815, 0.5999705195426941]}, {"fish_idx": 55, "predator_index": 0, "fish_position": [-1.25439453125, 0.056814827024936676], "predator_position": [-1.8106086254119873, 0.04909985885024071], "predator_velocity": [-0.16356708109378815, 0.5999705195426941]}, {"fish_idx": 73, "predator_index": 0, "fish_position": [-1.5282386541366577, 0.48563823103904724], "predator_position": [-1.8106086254119873, 0.04909985885024071], "predator_velocity": [-0.16356708109378815, 0.5999705195426941]}, {"fish_idx": 15, "predator_index": 0, "fish_position": [-0.310750812292099, 2.0701711177825928], "predator_position": [0.10416106879711151, 1.7332589626312256], "predator_velocity": [-0.12241821736097336, 1.266985297203064]}, {"fish_idx": 77, "predator_index": 0, "fish_position": [-0.16969463229179382, 1.4215366840362549], "predator_position": [0.10416106879711151, 1.7332589626312256], "predator_velocity": [-0.12241821736097336, 1.266985297203064]}, {"fish_idx": 50, "predator_index": 0, "fish_position": [-1.0959386825561523, -0.31330960988998413], "predator_position": [-1.1978058815002441, -0.4197677969932556], "predator_velocity": [-2.0033974647521973, 1.4734761714935303]}, {"fish_idx": 51, "predator_index": 0, "fish_position": [-0.9510469436645508, -0.5796324014663696], "predator_position": [-1.1978058815002441, -0.4197677969932556], "predator_velocity": [-2.0033974647521973, 1.4734761714935303]}, {"fish_idx": 8, "predator_index": 0, "fish_position": [-0.8938598036766052, 0.894167423248291], "predator_position": [-1.048986554145813, 1.187941551208496], "predator_velocity": [-0.10641898959875107, 0.9236341714859009]}, {"fish_idx": 16, "predator_index": 0, "fish_position": [0.06476191431283951, 0.7271480560302734], "predator_position": [0.5227388739585876, 0.7890849113464355], "predator_velocity": [0.04219774529337883, 1.0014302730560303]}, {"fish_idx": 61, "predator_index": 0, "fish_position": [0.21348239481449127, 0.9012364149093628], "predator_position": [0.5227388739585876, 0.7890849113464355], "predator_velocity": [0.04219774529337883, 1.0014302730560303]}, {"fish_idx": 9, "predator_index": 0, "fish_position": [-2.4122657775878906, -0.6185864210128784], "predator_position": [-2.248173952102661, -0.1116466373205185], "predator_velocity": [-1.855444312095642, 0.094011090695858]}, {"fish_idx": 13, "predator_index": 0, "fish_position": [-1.6101617813110352, 0.09560848772525787], "predator_position": [-2.248173952102661, -0.1116466373205185], "predator_velocity": [-1.855444312095642, 0.094011090695858]}, {"fish_idx": 59, "predator_index": 0, "fish_position": [-2.320415735244751, -0.33822768926620483], "predator_position": [-2.248173952102661, -0.1116466373205185], "predator_velocity": [-1.855444312095642, 0.094011090695858]}, {"fish_idx": 65, "predator_index": 0, "fish_position": [-2.4369421005249023, -0.33617350459098816], "predator_position": [-2.248173952102661, -0.1116466373205185], "predator_velocity": [-1.855444312095642, 0.094011090695858]}, {"fish_idx": 38, "predator_index": 0, "fish_position": [-0.301742285490036, -1.6950135231018066], "predator_position": [-0.11135029047727585, -1.8004976511001587], "predator_velocity": [-0.1630392074584961, -0.0900411307811737]}, {"fish_idx": 65, "predator_index": 0, "fish_position": [0.43728217482566833, -2.0231916904449463], "predator_position": [-0.11135029047727585, -1.8004976511001587], "predator_velocity": [-0.1630392074584961, -0.0900411307811737]}, {"fish_idx": 86, "predator_index": 0, "fish_position": [0.41740939021110535, -1.8471744060516357], "predator_position": [-0.11135029047727585, -1.8004976511001587], "predator_velocity": [-0.1630392074584961, -0.0900411307811737]}, {"fish_idx": 93, "predator_index": 0, "fish_position": [-0.010875511914491653, -2.3414254188537598], "predator_position": [-0.11135029047727585, -1.8004976511001587], "predator_velocity": [-0.1630392074584961, -0.0900411307811737]}, {"fish_idx": 9, "predator_index": 0, "fish_position": [0.5824834108352661, -0.05950713902711868], "predator_position": [0.4181228280067444, 0.16695114970207214], "predator_velocity": [-0.0833628699183464, 0.37458211183547974]}, {"fish_idx": 30, "predator_index": 0, "fish_position": [-0.17818671464920044, 0.10873564332723618], "predator_position": [0.4181228280067444, 0.16695114970207214], "predator_velocity": [-0.0833628699183464, 0.37458211183547974]}, {"fish_idx": 33, "predator_index": 0, "fish_position": [0.13231343030929565, 0.22023934125900269], "predator_position": [0.4181228280067444, 0.16695114970207214], "predator_velocity": [-0.0833628699183464, 0.37458211183547974]}, {"fish_idx": 39, "predator_index": 0, "fish_position": [0.6759053468704224, -0.06763622164726257], "predator_position": [0.4181228280067444, 0.16695114970207214], "predator_velocity": [-0.0833628699183464, 0.37458211183547974]}, {"fish_idx": 54, "predator_index": 0, "fish_position": [0.05241331085562706, 0.19291694462299347], "predator_position": [0.4181228280067444, 0.16695114970207214], "predator_velocity": [-0.0833628699183464, 0.37458211183547974]}, {"fish_idx": 79, "predator_index": 0, "fish_position": [0.18310067057609558, 0.5719406604766846], "predator_position": [0.4181228280067444, 0.16695114970207214], "predator_velocity": [-0.0833628699183464, 0.37458211183547974]}, {"fish_idx": 73, "predator_index": 0, "fish_position": [-0.5918117165565491, -1.7448855638504028], "predator_position": [-0.826607346534729, -2.0941078662872314], "predator_velocity": [0.10244237631559372, -0.19135147333145142]}, {"fish_idx": 40, "predator_index": 0, "fish_position": [0.3691851496696472, -2.380733013153076], "predator_position": [0.516646683216095, -1.8395191431045532], "predator_velocity": [0.12266475707292557, -0.03565576300024986]}, {"fish_idx": 42, "predator_index": 0, "fish_position": [0.2357439249753952, -2.265589952468872], "predator_position": [0.516646683216095, -1.8395191431045532], "predator_velocity": [0.12266475707292557, -0.03565576300024986]}, {"fish_idx": 49, "predator_index": 0, "fish_position": [0.40351611375808716, -1.6539874076843262], "predator_position": [0.516646683216095, -1.8395191431045532], "predator_velocity": [0.12266475707292557, -0.03565576300024986]}, {"fish_idx": 81, "predator_index": 0, "fish_position": [0.08456219732761383, 3.110898494720459], "predator_position": [0.5783411860466003, 2.8430404663085938], "predator_velocity": [0.08139311522245407, 0.6008355021476746]}], "step_one_clusters": {"total": 31, "angle_bin_deg": 30.0, "speed_bin": 0.4, "clusters": [{"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 6, "share": 0.1935483870967742}, {"angle_deg_start": 150.0, "angle_deg_end": 180.0, "speed_bin_start": 1.6, "speed_bin_end": 2.0, "count": 4, "share": 0.12903225806451613}, {"angle_deg_start": 180.0, "angle_deg_end": 210.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 4, "share": 0.12903225806451613}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.4, "speed_bin_end": 0.8, "count": 3, "share": 0.0967741935483871}, {"angle_deg_start": 330.0, "angle_deg_end": 360.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 3, "share": 0.0967741935483871}, {"angle_deg_start": 0.0, "angle_deg_end": 30.0, "speed_bin_start": 1.6, "speed_bin_end": 2.0, "count": 2, "share": 0.06451612903225806}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 1.2000000000000002, "speed_bin_end": 1.6, "count": 2, "share": 0.06451612903225806}, {"angle_deg_start": 120.0, "angle_deg_end": 150.0, "speed_bin_start": 2.4000000000000004, "speed_bin_end": 2.8000000000000003, "count": 2, "share": 0.06451612903225806}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 2, "share": 0.06451612903225806}, {"angle_deg_start": 90.0, "angle_deg_end": 120.0, "speed_bin_start": 0.8, "speed_bin_end": 1.2000000000000002, "count": 1, "share": 0.03225806451612903}, {"angle_deg_start": 270.0, "angle_deg_end": 300.0, "speed_bin_start": 0.0, "speed_bin_end": 0.4, "count": 1, "share": 0.03225806451612903}, {"angle_deg_start": 60.0, "angle_deg_end": 90.0, "speed_bin_start": 0.4, "speed_bin_end": 0.8, "count": 1, "share": 0.03225806451612903}]}, "step_one_ne_high_speed_share": 0.06451612903225806, "pre_roll_stats_summary": {"sampled_episodes": 16, "spawn_radius": {"count": 16, "mean": 0.8274678383022547, "std": 0.43692115767074435, "p10": 0.28258587419986725, "p50": 0.8357600569725037, "p90": 1.3929555416107178, "min": 0.0685652494430542, "max": 1.4030119180679321}, "spawn_angle_deg": {"count": 16, "mean": -22.414365649223328, "std": 110.15454222616984, "p10": -167.97078704833984, "p50": -11.975772857666016, "p90": 115.63016128540039, "min": -174.71743774414062, "max": 148.90121459960938}, "initial_heading_deg": {"count": 16, "mean": -55.11766970157623, "std": 80.68094145397595, "p10": -149.77915954589844, "p50": -82.01249694824219, "p90": 44.80645179748535, "min": -173.02224731445312, "max": 88.31886291503906}, "final_heading_deg": {"count": 16, "mean": 66.49303528666496, "std": 83.0656975818455, "p10": -50.963661193847656, "p50": 92.15964126586914, "p90": 154.526611328125, "min": -139.33935546875, "max": 178.64120483398438}, "initial_speed": {"count": 16, "mean": 1.5000000223517418, "std": 4.652886091469525e-08, "p10": 1.5, "p50": 1.5, "p90": 1.5000001192092896, "min": 1.5, "max": 1.5000001192092896}, "final_speed": {"count": 16, "mean": 1.1185361435636878, "std": 0.7859975680558254, "p10": 0.23855945467948914, "p50": 0.9162287414073944, "p90": 2.2443567514419556, "min": 0.14961133897304535, "max": 2.45761775970459}, "angle_jitter_deg": {"count": 256, "mean": 0.41894270677237133, "std": 9.817556963963066, "p10": -14.011924075126856, "p50": 1.1202718149907525, "p90": 14.106326228598881, "min": -17.05229400435058, "max": 17.024607666844936}, "speed_scale": {"count": 256, "mean": 2.2662735755205787, "std": 5.478225043371946, "p10": 0.17872533314827654, "p50": 1.0138874353047052, "p90": 4.131276236033537, "min": 0.015054615455519348, "max": 71.57722876509615}, "heading_bias_angle_deg": {"count": 16, "mean": 169.88232792843274, "std": 104.41478029406713, "p10": 26.95306186655845, "p50": 210.22083072961982, "p90": 277.98750174986486, "min": 14.833148551202237, "max": 291.0061368656119}, "prewarm_override_count": 0, "prewarm_override_ratio": 0.0, "spawn_angle_hist_deg": {"bins": [2, 1, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0], "edges": [0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, 210.0, 240.0, 270.0, 300.0, 330.0, 360.0]}, "initial_speed_hist": {"bins": [0, 0, 0, 0, 0, 0, 0, 0, 0, 16], "edges": [0.0, 0.16, 0.32, 0.48, 0.64, 0.8, 0.96, 1.12, 1.28, 1.44, 1.6]}}, "penalty_gate": {"event": "noop", "stage": 0, "phase_limit": 3, "success_streak": 0, "freeze_until": 53, "failure_detected": false, "failure_streak": 0, "rolling_p10_median": 102.5, "rolling_early_death_median": 0.10026041666666667, "rolling_early_death_median_stage": 0.10026041666666667, "tail_stage_type": "main", "early_death_threshold": 0.1, "step_one_death_ratio": 0.020182291666666668}}
